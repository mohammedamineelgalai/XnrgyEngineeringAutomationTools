<Window x:Class="XnrgyEngineeringAutomationTools.Modules.OpenVaultProject.Views.OpenVaultProjectWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="{StaticResource WindowTitleOpenVaultProject}" 
        Height="900" Width="1100"
        MinHeight="700" MinWidth="900"
        WindowStartupLocation="CenterOwner"
        Background="#1E1E2E"
        Loaded="Window_Loaded">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/Styles/XnrgyStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- Couleurs XNRGY -->
            <SolidColorBrush x:Key="XnrgyBlue" Color="#0078D4"/>
            <SolidColorBrush x:Key="XnrgyGreen" Color="#107C10"/>
            <SolidColorBrush x:Key="XnrgyOrange" Color="#FF8C00"/>
            <SolidColorBrush x:Key="DarkBg" Color="#1E1E2E"/>
            <SolidColorBrush x:Key="DarkBg2" Color="#252536"/>
            <SolidColorBrush x:Key="BorderColor" Color="#4A7FBF"/>

            <!-- Style liste item -->
            <Style x:Key="VaultItemStyle" TargetType="ListBoxItem">
                <Setter Property="Background" Value="#252536"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="Margin" Value="2"/>
                <Setter Property="Padding" Value="12,10"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ListBoxItem">
                            <Border x:Name="border" Background="{TemplateBinding Background}" 
                                    CornerRadius="6" BorderBrush="#4A7FBF" BorderThickness="1"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#2A5A8F"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#00D4FF"/>
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#0078D4"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#00D4FF"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="border" Property="Background" Value="#252536"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#3A3A4A"/>
                                    <Setter TargetName="border" Property="Opacity" Value="0.6"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Style ListBox sombre (conserve le fond sombre quand desactive) -->
            <Style x:Key="DarkListBox" TargetType="ListBox">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Style.Triggers>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Opacity" Value="0.6"/>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- Style bouton action -->
            <Style x:Key="ActionButton" TargetType="Button">
                <Setter Property="Background" Value="#0078D4"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Padding" Value="20,12"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" Background="{TemplateBinding Background}" 
                                    CornerRadius="8" BorderBrush="#4A7FBF" BorderThickness="2"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#1E90FF"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#00D4FF"/>
                                    <Setter TargetName="border" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#00D4FF" BlurRadius="20" ShadowDepth="0" Opacity="0.7"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="border" Property="Background" Value="#555555"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#444444"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="150"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2A4A6F" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="#0EA5E9" CornerRadius="12" Width="55" Height="55" Margin="0,0,15,0">
                        <TextBlock Text="ðŸ“¥" FontSize="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Ouvrir Projet" FontSize="22" FontWeight="Bold" Foreground="White"/>
                        <TextBlock x:Name="TxtHeaderSubtitle" Text="Telecharger et ouvrir un module depuis Vault" FontSize="13" Foreground="#B0B0B0" Margin="0,4,0,0"/>
                    </StackPanel>
                </StackPanel>

                <Button x:Name="BtnRefresh" Grid.Column="1" Content="ðŸ”„ Actualiser" 
                        Style="{StaticResource ActionButton}" Background="#6366F1"
                        Click="BtnRefresh_Click"/>
            </Grid>
        </Border>

        <!-- TabControl avec 2 onglets: Vault et Local -->
        <TabControl x:Name="TabSourceSelection" Grid.Row="1" Background="Transparent" BorderThickness="0" 
                    Margin="20,15" SelectionChanged="TabSourceSelection_SelectionChanged">
            <TabControl.Resources>
                <!-- Style onglet XNRGY -->
                <Style TargetType="TabItem">
                    <Setter Property="Background" Value="#252536"/>
                    <Setter Property="Foreground" Value="#B0B0B0"/>
                    <Setter Property="FontSize" Value="14"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                    <Setter Property="Padding" Value="20,10"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border x:Name="TabBorder" Background="{TemplateBinding Background}" 
                                        CornerRadius="8,8,0,0" BorderBrush="#4A7FBF" BorderThickness="2,2,2,0"
                                        Padding="{TemplateBinding Padding}" Margin="2,0,2,0">
                                    <ContentPresenter x:Name="ContentSite" ContentSource="Header" 
                                                      HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="TabBorder" Property="Background" Value="#0078D4"/>
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter TargetName="TabBorder" Property="BorderBrush" Value="#00D4FF"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="TabBorder" Property="Background" Value="#2A5A8F"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.Resources>

            <!-- Onglet 1: Vault (par defaut) -->
            <TabItem x:Name="TabVault" IsSelected="True">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ—„ï¸" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="Vault"/>
                    </StackPanel>
                </TabItem.Header>
                
                <Grid Margin="0,15,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Colonne 1: Projets Vault -->
                    <GroupBox Grid.Column="0" Style="{StaticResource XnrgyGroupBox}" Margin="0,0,10,0">
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Projets" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                <TextBlock x:Name="TxtProjectCount" Text=" (0)" FontSize="14" Foreground="#B0B0B0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </GroupBox.Header>
                        <ListBox x:Name="LstProjects" Style="{StaticResource DarkListBox}"
                                 ItemContainerStyle="{StaticResource VaultItemStyle}"
                                 SelectionChanged="LstProjects_SelectionChanged"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding TypeIcon}" FontSize="18" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                            <TextBlock Text="{Binding LastModified, StringFormat='Modifie: {0:dd/MM/yyyy}'}" 
                                                       FontSize="11" Foreground="#888888"/>
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </GroupBox>

                    <!-- Colonne 2: References Vault -->
                    <GroupBox Grid.Column="1" Style="{StaticResource XnrgyGroupBox}" Margin="5,0">
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“‚" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="References" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                <TextBlock x:Name="TxtRefCount" Text=" (0)" FontSize="14" Foreground="#B0B0B0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </GroupBox.Header>
                        <ListBox x:Name="LstReferences" Style="{StaticResource DarkListBox}"
                                 ItemContainerStyle="{StaticResource VaultItemStyle}"
                                 SelectionChanged="LstReferences_SelectionChanged"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding TypeIcon}" FontSize="18" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                            <TextBlock Text="{Binding LastModified, StringFormat='Modifie: {0:dd/MM/yyyy}'}" 
                                                       FontSize="11" Foreground="#888888"/>
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </GroupBox>

                    <!-- Colonne 3: Modules Vault -->
                    <GroupBox Grid.Column="2" Style="{StaticResource XnrgyGroupBox}" Margin="10,0,0,0">
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“¦" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Modules" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                <TextBlock x:Name="TxtModuleCount" Text=" (0)" FontSize="14" Foreground="#B0B0B0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </GroupBox.Header>
                        <ListBox x:Name="LstModules" Style="{StaticResource DarkListBox}"
                                 ItemContainerStyle="{StaticResource VaultItemStyle}"
                                 SelectionChanged="LstModules_SelectionChanged"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding TypeIcon}" FontSize="18" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                            <TextBlock Text="{Binding LastModified, StringFormat='Modifie: {0:dd/MM/yyyy}'}" 
                                                       FontSize="11" Foreground="#888888"/>
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Onglet 2: Local -->
            <TabItem x:Name="TabLocal">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="Local"/>
                    </StackPanel>
                </TabItem.Header>
                
                <Grid Margin="0,15,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Colonne 1: Projets Local -->
                    <GroupBox Grid.Column="0" Style="{StaticResource XnrgyGroupBox}" Margin="0,0,10,0">
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Projets" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                <TextBlock x:Name="TxtLocalProjectCount" Text=" (0)" FontSize="14" Foreground="#B0B0B0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </GroupBox.Header>
                        <ListBox x:Name="LstLocalProjects" Style="{StaticResource DarkListBox}"
                                 ItemContainerStyle="{StaticResource VaultItemStyle}"
                                 SelectionChanged="LstLocalProjects_SelectionChanged"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding TypeIcon}" FontSize="18" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                            <TextBlock Text="{Binding LastModified, StringFormat='Modifie: {0:dd/MM/yyyy}'}" 
                                                       FontSize="11" Foreground="#888888"/>
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </GroupBox>

                    <!-- Colonne 2: References Local -->
                    <GroupBox Grid.Column="1" Style="{StaticResource XnrgyGroupBox}" Margin="5,0">
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“‚" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="References" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                <TextBlock x:Name="TxtLocalRefCount" Text=" (0)" FontSize="14" Foreground="#B0B0B0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </GroupBox.Header>
                        <ListBox x:Name="LstLocalReferences" Style="{StaticResource DarkListBox}"
                                 ItemContainerStyle="{StaticResource VaultItemStyle}"
                                 SelectionChanged="LstLocalReferences_SelectionChanged"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding TypeIcon}" FontSize="18" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                            <TextBlock Text="{Binding LastModified, StringFormat='Modifie: {0:dd/MM/yyyy}'}" 
                                                       FontSize="11" Foreground="#888888"/>
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </GroupBox>

                    <!-- Colonne 3: Modules Local -->
                    <GroupBox Grid.Column="2" Style="{StaticResource XnrgyGroupBox}" Margin="10,0,0,0">
                        <GroupBox.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“¦" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Modules" FontSize="16" FontWeight="Bold" Foreground="White"/>
                                <TextBlock x:Name="TxtLocalModuleCount" Text=" (0)" FontSize="14" Foreground="#B0B0B0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </GroupBox.Header>
                        <ListBox x:Name="LstLocalModules" Style="{StaticResource DarkListBox}"
                                 ItemContainerStyle="{StaticResource VaultItemStyle}"
                                 SelectionChanged="LstLocalModules_SelectionChanged"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding TypeIcon}" FontSize="18" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" FontSize="14" FontWeight="Bold" Foreground="White"/>
                                            <TextBlock Text="{Binding LastModified, StringFormat='Modifie: {0:dd/MM/yyyy}'}" 
                                                       FontSize="11" Foreground="#888888"/>
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </GroupBox>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Barre de progression moderne avec temps et pourcentage -->
        <Border Grid.Row="2" Background="#2A4A6F" CornerRadius="8" Margin="20,10,20,10" Padding="15,12"
                BorderBrush="#4A7FBF" BorderThickness="2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Barre de progression avec texte de statut integre -->
                <Border Grid.Column="0" Background="#1E1E2E" CornerRadius="8" 
                        Height="44" Margin="0,0,15,0" ClipToBounds="True"
                        BorderBrush="#4A7FBF" BorderThickness="2">
                    <Grid>
                        <!-- Barre de progression verte avec effet glow -->
                        <Border x:Name="ProgressBarFill" Background="#28A745" CornerRadius="8" HorizontalAlignment="Left" Width="0">
                            <Border.Effect>
                                <DropShadowEffect Color="#00FF7F" BlurRadius="15" ShadowDepth="0" Opacity="0.45"/>
                            </Border.Effect>
                        </Border>
                        
                        <!-- Texte de statut -->
                        <TextBlock x:Name="TxtStatus" 
                                   Text="Pret - Selectionnez un module a telecharger" 
                                   Foreground="White" FontSize="12" FontWeight="Bold"
                                   VerticalAlignment="Center" HorizontalAlignment="Left"
                                   Margin="12,0,0,0" TextTrimming="CharacterEllipsis" MaxWidth="280"/>
                        
                        <!-- Fichier en cours -->
                        <TextBlock x:Name="TxtCurrentFile" 
                                   Text="" 
                                   Foreground="White" FontSize="11" FontWeight="Bold"
                                   VerticalAlignment="Center" HorizontalAlignment="Left"
                                   Margin="300,0,0,0" TextTrimming="CharacterEllipsis" MaxWidth="200"/>
                        
                        <!-- Temps ecoule et pourcentage -->
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,12,0">
                            <TextBlock x:Name="TxtTimeLabel" Text="Ecoule: " Foreground="White" FontSize="11" FontWeight="Bold" VerticalAlignment="Center" Visibility="Collapsed"/>
                            <TextBlock x:Name="TxtProgressTimeElapsed" Text="00:00" Foreground="White" FontSize="11" FontWeight="Bold" VerticalAlignment="Center" Visibility="Collapsed"/>
                            <TextBlock x:Name="TxtEstimatedLabel" Text=" / Estime: " Foreground="White" FontSize="11" FontWeight="Bold" VerticalAlignment="Center" Margin="4,0,0,0" Visibility="Collapsed"/>
                            <TextBlock x:Name="TxtProgressTimeEstimated" Text="00:00" Foreground="White" FontSize="11" FontWeight="Bold" VerticalAlignment="Center" Visibility="Collapsed"/>
                            <TextBlock x:Name="TxtSeparator" Text=" | " Foreground="White" FontSize="11" FontWeight="Bold" VerticalAlignment="Center" Margin="8,0,8,0" Visibility="Collapsed"/>
                            <TextBlock x:Name="TxtProgressPercent" Text="0%" Foreground="White" FontSize="12" FontWeight="Bold" VerticalAlignment="Center" Visibility="Collapsed"/>
                            <TextBlock x:Name="TxtFileProgress" Text="" Foreground="White" FontSize="11" FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Bouton Telecharger (meme hauteur que barre de progression) -->
                <Button x:Name="BtnDownload" Grid.Column="1" Content="ðŸ“¥ Ouvrir" 
                        Style="{StaticResource ActionButton}" Background="#10B981"
                        Height="44" MinWidth="160" FontSize="14" FontWeight="Bold"
                        HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                        Padding="15,0"
                        IsEnabled="False" Click="BtnDownload_Click"/>
            </Grid>
        </Border>

        <!-- Journal -->
        <Border Grid.Row="3" Background="#12121C" CornerRadius="8" Margin="20,0,20,10" BorderBrush="#4A7FBF" BorderThickness="2">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <Border Grid.Row="0" Background="#2A4A6F" CornerRadius="6,6,0,0" Padding="12,8">
                    <Grid>
                        <TextBlock Text="ðŸ“‹ Journal des Operations" FontSize="14" FontWeight="Bold" Foreground="White"/>
                        <Button x:Name="BtnClearLog" Content="ðŸ—‘ï¸ Effacer" HorizontalAlignment="Right" 
                                Background="#DC2626" Foreground="White" FontWeight="Bold"
                                BorderBrush="#DC2626" BorderThickness="2"
                                Padding="8,4" Click="BtnClearLog_Click" Cursor="Hand">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" 
                                            BorderBrush="{TemplateBinding BorderBrush}" 
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            CornerRadius="4" Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </Grid>
                </Border>
                
                <ListBox x:Name="LstLog" Grid.Row="1" Background="Transparent" BorderThickness="0"
                         FontFamily="Consolas" FontSize="12" Foreground="White"
                         ScrollViewer.VerticalScrollBarVisibility="Auto">
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem">
                            <Setter Property="Focusable" Value="False"/>
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Padding" Value="8,2"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ListBoxItem">
                                        <ContentPresenter/>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListBox.ItemContainerStyle>
                </ListBox>
            </Grid>
        </Border>

        <!-- Copyright Bar -->
        <Border Grid.Row="4" Style="{StaticResource CopyrightBarBorder}">
            <Grid>
                <TextBlock x:Name="StatusBarText" Text="Pret" Style="{StaticResource StatusTextStyle}"/>
                <TextBlock Style="{StaticResource CopyrightTextStyle}" HorizontalAlignment="Right"
                           Text="{StaticResource CopyrightOpenVaultProject}"/>
            </Grid>
        </Border>
    </Grid>
</Window>
