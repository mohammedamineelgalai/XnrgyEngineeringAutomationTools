<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:innovasys xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
    <!--DXMETADATA start type="MetaCharset" --><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"><!--DXMETADATA end-->
    <meta content="history" name="save" />
    <meta name="GENERATOR" content="Innovasys HelpStudio (http://www.innovasys.com)" />
    <!--DXMETADATA start type="ItemTitle" format="<title>%%ItemTitle%%</title>" --><title>LINQ is Your Friend</title><!--DXMETADATA end-->
    <link rel="stylesheet" type="text/css" href="stylesheets/helpstudio.css" />
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/community.css"">" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="Literal" condition="helpversion:value=2" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/help2.css"">" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Stylesheets" --><link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-heading-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-tabstrip.css"></link><!--DXMETADATA end-->
    <script src="script/helpstudio.js" type="text/javascript"></script>
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<script src=""script/community.js""></script>" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Scripts" --><script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="Variable" name="BannerColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {background-color: %%Variable%%}</style>" blankformat="" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Variable" name="BannerTextColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {color: %%Variable:Name=BannerTextColor%%}</style>" blankformat="" --><!--DXMETADATA end -->
	<!--DXMETADATA start type="Variable" name="TopicXMLIsland" condition="helpversion:value=2" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="DesignTime" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CanonicalLink" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CustomHeadContent" --><!--DXMETADATA end-->
</head>
<body id="hsbody">
	<!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_PROPERTIES" --><!--DXMETADATA end -->
    <div style="display: none">
        <input type="hidden" id="userDataCache" class="userDataStyle" name="userDataCache" />
        <input type="hidden" id="hiddenScrollOffset" name="hiddenScrollOffset" />
    </div>
    <img id="collapseImage" style="display:none; height:0; width:0;" src="images/collapse.gif">
    <img id="expandImage" style="display:none; height:0; width:0;" src="images/expand.gif"/>
    <img id="copyImage" style="display:none; height:0; width:0;" src="images/copycode.gif"/>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="images/copycodeHighlight.gif">
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="images/drpdown.gif"/>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="images/drpdown_orange.gif"/>
    <div id="pagetop">
        <!--DXMETADATA start type="DesignBanner" --><!--DXMETADATA end -->
        <table width="100%" id="pagetoptable2" cellspacing="0" cellpadding="0">
        	<tr>
        		<td><!--DXMETADATA start type="Literal" condition="communityenabled" value="%%scrap:name=_COMMUNITY_RATING%%%%scrap:name=_COMMUNITY_DROPDOWN%%" --><!--DXMETADATA end --></td>
        	</tr>
        </table>
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">
                        <!--DXMETADATA start type="ProjectTitle" -->Vault SDK<!--DXMETADATA end-->
                    </span>
                </td>
                <td align="right" rowspan="2">
                    <!--DXMETADATA start type="LogoImage" --><!--DXMETADATA end-->
                </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left">
                    <span id="pagetitle">
                        <!--DXMETADATA start type="ItemTitle" -->LINQ is Your Friend<!--DXMETADATA end-->
                    </span>
                </td>
            </tr>
            <tr id="pagetoptable1row3">
            	<td colspan="2">
            		<!--DXMETADATA start type="Literal" condition="childitems:itemtype=linkcategory" value="<a href=""#seealsobookmark"">%%Phrase:Name=SeeAlso,BlankFormat=See Also%%</a>" --><!--DXMETADATA end -->
            		<span id="feedbacklink"><!--DXMETADATA start type="Variable" name="FeedbackLink" format="" --><a href="http://forums.autodesk.com/t5/vault-customization/bd-p/301 " rel="noopener noreferrer" target="_blank">Send Feedback</a><!--DXMETADATA end --></span>
            	</td>
            </tr>
        </table>
        <!--DXMETADATA start type="Breadcrumbs" scrap="_BREADCRUMBS" --><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="topic46.html">Knowledge Base</a>
 > LINQ is Your Friend</td></tr></table><!--DXMETADATA end -->
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_MENU" --><!--DXMETADATA end -->
    </div>
    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>
    <div id="pagebody">
        <div id="mainbody">
<!--DXMETADATA start type="TopicSection" name="BodyText"--><p class="mainpage">by Doug Redmond, It's All Just Ones and Zeros<br />
06/29/2010</p>

<div class="mainpage">
    <br />
</div>

<p class="mainpage">When programming with Vault, you end up dealing with arrays a lot.&nbsp; I find myself constantly looping through arrays trying to find the 1 object I am looking for.&nbsp; Or I have an array of objects that I need to convert to an array of IDs.</p>

<p class="mainpage">.NET 3.0 has a nice feature, LINQ, that makes these operations much easier than creating foreach loops all the time.&nbsp; It's basically a query syntax for .NET collections.&nbsp; If you are a fan of SQL, then you should have no trouble picking up LINQ.&nbsp; Even if you are unfamiliar with SQL, the syntax is pretty easy to work with.&nbsp;&nbsp;</p>

<p class="mainpage">For example, let's say you want to find a specific property definition in an array of PropDef objects.</p>

<div class="mainpage">
    <div id="Syntax_CS" class="LanguageSpecific" data-title="CS" data-itemid="CS">
        <table class="syntaxtable" cellspacing="0" cellpadding="0">
            <tbody>
                <tr>
                    <th class="codeboxtitlecell">C Sharp</th>

                    <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
                </tr>

                <tr>
                    <td colspan="2">
                        <pre>
PropDef [] fileProps = webServiceManager.PropertyService.GetPropertyDefinitionsByEntityClassId(<span style="COLOR: #800000">"FILE"</span>); 
<span style="COLOR: #008000">// use LINQ to query the array 
</span>IEnumerable&lt;PropDef&gt; selection = 
   <span style="COLOR: #0000ff">from</span> propDef <span style="COLOR: #0000ff">in</span> fileProps 
   <span style="COLOR: #0000ff">where</span> propDef.DispName == <span style="COLOR: #800000">"My custom property"</span> 
   <span style="COLOR: #0000ff">select</span> propDef;
<span style="COLOR: #0000ff">if</span> (selection.Count() == 0) 
    <span style="COLOR: #0000ff">throw</span> <span style="COLOR: #0000ff">new</span> Exception(<span style="COLOR: #800000">"Property not found"</span>); 
PropDef fileNamePropDef = selection.First(); 
</pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div id="Syntax_VB.NET" class="LanguageSpecific" data-title="VB.NET" data-itemid="VB.NET">
    <table class="syntaxtable" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th class="codeboxtitlecell">VB.NET</th>

                <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
            </tr>

            <tr>
                <td colspan="2">
                    <pre>
<span style="COLOR: #008000">' VB.NET
</span><span style="COLOR: #0000ff">Dim</span> fileProps <span style="COLOR: #0000ff">As</span> PropDef() = webServiceManager.PropertyService.GetPropertyDefinitionsByEntityClassId(<span style="COLOR: #800000">"FILE"</span>) 
<span style="COLOR: #008000">' use LINQ to query the array 
</span><span style="COLOR: #0000ff">Dim</span> selection <span style="COLOR: #0000ff">As</span> IEnumerable(<span style="COLOR: #0000ff">Of</span> PropDef) = _ 
    <span style="COLOR: #0000ff">From</span> propDef <span style="COLOR: #0000ff">In</span> fileProps _ 
      <span style="COLOR: #0000ff">Where</span> propDef.DispName = <span style="COLOR: #800000">"My custom property"</span> _ 
      <span style="COLOR: #0000ff">Select</span> propDef 

<span style="COLOR: #0000ff">If</span> selection.Count() = 0 <span style="COLOR: #0000ff">Then</span> 
      <span style="COLOR: #0000ff">Throw</span> <span style="COLOR: #0000ff">New</span> Exception(<span style="COLOR: #800000">"Property not found"</span>) 
<span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span> 
<span style="COLOR: #0000ff">Dim</span> fileNamePropDef <span style="COLOR: #0000ff">As</span> PropDef = selection.First()
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<p class="mainpage">Now let's convert from File array to ID array.</p>

<div id="Syntax_CS" class="LanguageSpecific" data-title="CS" data-itemid="CS">
    <table class="syntaxtable" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th class="codeboxtitlecell">C Sharp</th>

                <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
            </tr>

            <tr>
                <td colspan="2">
                    <pre>
File [] files = webServiceManager.DocumentService.GetLatestFilesByFolderId(root.Id, <span style="COLOR: #0000ff">true</span>); 

<span style="COLOR: #008000">// use LINQ to get the ID values 
</span>IEnumerable&lt;<span style="COLOR: #0000ff">long</span>&gt; ids =  
   <span style="COLOR: #0000ff">from</span> file <span style="COLOR: #0000ff">in</span> files  
   <span style="COLOR: #0000ff">select</span> file.Id; 

<span style="COLOR: #0000ff">long</span>[] fileIdArray = ids.ToArray(); 
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div id="Syntax_VB.NET" class="LanguageSpecific" data-title="VB.NET" data-itemid="VB.NET">
    <table class="syntaxtable" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th class="codeboxtitlecell">VB.NET</th>

                <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
            </tr>

            <tr>
                <td colspan="2">
                    <pre>
<span style="COLOR: #0000ff">Dim</span> files <span style="COLOR: #0000ff">As</span> File() = webServiceManager.DocumentService.GetLatestFilesByFolderId(root.Id, <span style="COLOR: #0000ff">True</span>) 

<span style="COLOR: #008000">' use LINQ to get the ID values 
</span><span style="COLOR: #0000ff">Dim</span> ids <span style="COLOR: #0000ff">As</span> IEnumerable(<span style="COLOR: #0000ff">Of</span> <span style="COLOR: #0000ff">Long</span>) = _ 
      <span style="COLOR: #0000ff">From</span> file <span style="COLOR: #0000ff">In</span> files _ 
      <span style="COLOR: #0000ff">Select</span> file.Id 

<span style="COLOR: #0000ff">Dim</span> fileIdArray <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Long</span>() = ids.ToArray() 
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<p class="mainpage">It can also sort things for you.</p>

<div id="Syntax_CS" class="LanguageSpecific" data-title="CS" data-itemid="CS">
    <table class="syntaxtable" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th class="codeboxtitlecell">C Sharp</th>

                <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
            </tr>

            <tr>
                <td colspan="2">
                    <pre>
PropInst[] propValues = webServiceManager.PropertyService.GetProperties( 
<span style="COLOR: #800000">"FILE"</span>, fileIdArray, <span style="COLOR: #0000ff">new</span> <span style="COLOR: #0000ff">long</span>[]{ fileNamePropDef.Id }); 
<span style="COLOR: #008000">// LINQ will sort for you 
</span>IEnumerable&lt;PropInst&gt; sortedValues =  
    <span style="COLOR: #0000ff">from</span> value <span style="COLOR: #0000ff">in</span> propValues  
    <span style="COLOR: #0000ff">orderby</span> value.Val  
    <span style="COLOR: #0000ff">select</span> value; 

PropInst[] values1 = sortedValues.ToArray(); 
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div id="Syntax_VB.NET" class="LanguageSpecific" data-title="VB.NET" data-itemid="VB.NET">
    <table class="syntaxtable" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th class="codeboxtitlecell">VB.NET</th>

                <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
            </tr>

            <tr>
                <td colspan="2">
                    <pre>
<span style="COLOR: #0000ff">Dim</span> propValues <span style="COLOR: #0000ff">As</span> PropInst() = _ 
    webServiceManager.PropertyService.GetProperties(<span style="COLOR: #800000">"FILE"</span>, fileIdArray, _ 
    <span style="COLOR: #0000ff">New</span> <span style="COLOR: #0000ff">Long</span>() {fileNamePropDef.Id}) 
<span style="COLOR: #008000">' LINQ will sort for you 
</span><span style="COLOR: #0000ff">Dim</span> sortedValues <span style="COLOR: #0000ff">As</span> IEnumerable(<span style="COLOR: #0000ff">Of</span> PropInst) = _ 
      <span style="COLOR: #0000ff">From</span> value <span style="COLOR: #0000ff">In</span> propValues _ 
      <span style="COLOR: #0000ff">Order</span> <span style="COLOR: #0000ff">By</span> value.Val _ 
      <span style="COLOR: #0000ff">Select</span> value 
<span style="COLOR: #0000ff">Dim</span> values1 <span style="COLOR: #0000ff">As</span> PropInst() = sortedValues.ToArray()
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<p class="mainpage"></p>

<p class="mainpage"><strong>Lambda expressions</strong></p>

<p class="mainpage">In many cases, you can condense things further by using Lambda expressions.&nbsp; It's a bit of a trade-off though.&nbsp; The code is less readable, but you get that nice "I did it all in 1 line" feeling of satisfaction.</p>

<p class="mainpage">Here are the above examples C#, but in Lambda ( I don't think VB.NET supports Lambda):</p>

<div id="Syntax_CS" class="LanguageSpecific" data-title="CS" data-itemid="CS">
    <table class="syntaxtable" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th class="codeboxtitlecell">C Sharp</th>

                <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
            </tr>

            <tr>
                <td colspan="2">
                    <pre>
<span style="COLOR: #008000">// find my a specific item in the array 
</span>PropDef fileNamePropDef = fileProps.First(n =&gt; n.DispName == <span style="COLOR: #800000">"My custom property"</span>); 
<span style="COLOR: #008000">// convert to ID array 
</span>IEnumerable&lt;<span style="COLOR: #0000ff">long</span>&gt; ids = files.Select(n =&gt; n.Id); 
<span style="COLOR: #008000">// sort the array 
</span>IEnumerable&lt;PropInst&gt; sortedValues = propValues.OrderBy(n =&gt; n.Val);
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div class="mainpage">
    Like any other programming feature, there is potential for misuse of LINQ.&nbsp; I recommend reading up on the MSDN documentation for how to best use these new concepts.&nbsp; Personally, I suggest avoiding the 'var' keyword.
</div>

<p></p><!--DXMETADATA end-->
            <a name="seealsobookmark"></a>
            <!--DXMETADATA start type="FilteredItemList" scrap="CATEGORISED_LINKS" namespace="linkcategory" source="Item" filter="" NoHeader="True" NoFooter="True" format="%%replaceinquotes:value=false%%%%scrap:name=_COLLAPSIBLE_HEADER,idprefix=seealso,caption=""%%phrase:name=SeeAlso%%%%designlist:tagidentifier=seealso,itemtype=See Also%%""%%%%filtereditemlist%%</div>"--><!--DXMETADATA end-->
        </div>
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_FOOTER" --><!--DXMETADATA end -->
        <div id="pagefooter">
            <!--DXMETADATA start type="Variable" name="CopyrightNotice" format="<p>&nbsp;</p><p>&nbsp;</p><hr style=""height: 1px"" /><p>%%variable%%</p>" --><!--DXMETADATA end -->
        </div>
        <!--DXMETADATA start type="FeedbackSection" --><!--DXMETADATA end -->
    </div>
    <!--DXMETADATA start type="Variable" name="NonScrollingPageFooter" format="<div id=nonscrollingpagefooter>%%variable%%</div>" --><div id=nonscrollingpagefooter>&copy;2025. All Rights Reserved.</div><!--DXMETADATA end -->
</body>
</html>