<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:innovasys xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
    <!--DXMETADATA start type="MetaCharset" --><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"><!--DXMETADATA end-->
    <meta content="history" name="save" />
    <meta name="GENERATOR" content="Innovasys HelpStudio (http://www.innovasys.com)" />
    <!--DXMETADATA start type="ItemTitle" format="<title>%%ItemTitle%%</title>" --><title>Finding by Search Conditions</title><!--DXMETADATA end-->
    <link rel="stylesheet" type="text/css" href="stylesheets/helpstudio.css" />
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/community.css"">" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="Literal" condition="helpversion:value=2" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/help2.css"">" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Stylesheets" --><link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-heading-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-tabstrip.css"></link><!--DXMETADATA end-->
    <script src="script/helpstudio.js" type="text/javascript"></script>
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<script src=""script/community.js""></script>" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Scripts" --><script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="Variable" name="BannerColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {background-color: %%Variable%%}</style>" blankformat="" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Variable" name="BannerTextColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {color: %%Variable:Name=BannerTextColor%%}</style>" blankformat="" --><!--DXMETADATA end -->
	<!--DXMETADATA start type="Variable" name="TopicXMLIsland" condition="helpversion:value=2" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="DesignTime" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CanonicalLink" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CustomHeadContent" --><!--DXMETADATA end-->
</head>
<body id="hsbody">
	<!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_PROPERTIES" --><!--DXMETADATA end -->
    <div style="display: none">
        <input type="hidden" id="userDataCache" class="userDataStyle" name="userDataCache" />
        <input type="hidden" id="hiddenScrollOffset" name="hiddenScrollOffset" />
    </div>
    <img id="collapseImage" style="display:none; height:0; width:0;" src="images/collapse.gif">
    <img id="expandImage" style="display:none; height:0; width:0;" src="images/expand.gif"/>
    <img id="copyImage" style="display:none; height:0; width:0;" src="images/copycode.gif"/>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="images/copycodeHighlight.gif">
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="images/drpdown.gif"/>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="images/drpdown_orange.gif"/>
    <div id="pagetop">
        <!--DXMETADATA start type="DesignBanner" --><!--DXMETADATA end -->
        <table width="100%" id="pagetoptable2" cellspacing="0" cellpadding="0">
        	<tr>
        		<td><!--DXMETADATA start type="Literal" condition="communityenabled" value="%%scrap:name=_COMMUNITY_RATING%%%%scrap:name=_COMMUNITY_DROPDOWN%%" --><!--DXMETADATA end --></td>
        	</tr>
        </table>
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">
                        <!--DXMETADATA start type="ProjectTitle" -->Vault SDK<!--DXMETADATA end-->
                    </span>
                </td>
                <td align="right" rowspan="2">
                    <!--DXMETADATA start type="LogoImage" --><!--DXMETADATA end-->
                </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left">
                    <span id="pagetitle">
                        <!--DXMETADATA start type="ItemTitle" -->Finding by Search Conditions<!--DXMETADATA end-->
                    </span>
                </td>
            </tr>
            <tr id="pagetoptable1row3">
            	<td colspan="2">
            		<!--DXMETADATA start type="Literal" condition="childitems:itemtype=linkcategory" value="<a href=""#seealsobookmark"">%%Phrase:Name=SeeAlso,BlankFormat=See Also%%</a>" --><!--DXMETADATA end -->
            		<span id="feedbacklink"><!--DXMETADATA start type="Variable" name="FeedbackLink" format="" --><a href="http://forums.autodesk.com/t5/vault-customization/bd-p/301 " rel="noopener noreferrer" target="_blank">Send Feedback</a><!--DXMETADATA end --></span>
            	</td>
            </tr>
        </table>
        <!--DXMETADATA start type="Breadcrumbs" scrap="_BREADCRUMBS" --><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="topic46.html">Knowledge Base</a>
 > Finding by Search Conditions</td></tr></table><!--DXMETADATA end -->
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_MENU" --><!--DXMETADATA end -->
    </div>
    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>
    <div id="pagebody">
        <div id="mainbody">
<!--DXMETADATA start type="TopicSection" name="BodyText"--><p>by Doug Redmond, It's All Just Ones and Zeros<a href="http://justonesandzeros.typepad.com/" target="_blank"></a><br />
09/14/2012</p>

<p>&nbsp;</p>

<p>This article explains how to use the&nbsp;Find <span style="TEXT-DECORATION: underline">X</span> By Search Conditions functions.&nbsp;&nbsp;These Find functions are the API equivalent of the Advanced Find command in the UI.&nbsp; Hopefully you are familiar with the following dialog.</p>

<p><img border="0" alt="" src="AdvancedFind.png" /></p>

<p>The basic idea is that you construct your search criteria by chaining together a bunch of search conditions.&nbsp; The result set consists of all the entities that match the search conditions.</p>

<p>The results are returned in <strong>pages</strong> for performance reasons.&nbsp; By default, 100 is the page size, but that value can be changed in ADMS Console.&nbsp; You can also define <span style="COLOR: #232323"><strong>sort</strong></span> criteria, so that the results come back in a specific order.&nbsp; That way you can hopefully get what you want on the first page.</p>

<p>Each major entity type has it’s own set of Find by Search Conditions functions, but they all work basically the same.&nbsp; I will be focusing mainly on <a href="topic2180.html">FindFilesBySearchConditions</a> for this article.</p>
<hr style="COLOR: #5acb04" noshade="noshade" />

<p><strong>Sample code<br /></strong> I’ll start by showing the code, then explaining what is going on.</p>

<p></p>

<table cellspacing="0" cellpadding="2" width="470" border="1">
    <tbody>
        <tr>
            <td valign="top" width="470">
                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #008000">// C#</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #2b91af"><span style="FONT-SIZE: 9pt">PropDef</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">[] filePropDefs =</span></span></span></span> <span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">m_svcMgr.PropertyService.GetPropertyDefinitionsByEntityClassId(</span></span></span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt"><span style="COLOR: #a31515">"FILE"</span><span style="COLOR: #000000">);</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #2b91af"><span style="FONT-SIZE: 9pt">PropDef</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">checkedOutPropDef = filePropDefs.Single(n =&gt; n.SysName ==</span> <span style="COLOR: #a31515">"CheckoutUserName"</span><span style="COLOR: #000000">);</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #2b91af"><span style="FONT-SIZE: 9pt">PropDef</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">projectPropDef = filePropDefs.Single(n =&gt; n.SysName ==</span> <span style="COLOR: #a31515">"Project"</span><span style="COLOR: #000000">);</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none">&nbsp;</p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #2b91af"><span style="FONT-SIZE: 9pt">SrchCond</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">isCheckedOut =</span> <span style="COLOR: #0000ff">new</span> <span style="COLOR: #2b91af">SrchCond</span><span style="COLOR: #000000">()</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #000000">{</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">PropDefId = checkedOutPropDef.Id,</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">PropTyp =</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #2b91af">PropertySearchType</span><span style="COLOR: #000000">.SingleProperty,</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">SrchOper = 5,</span></span> <span style="FONT-SIZE: 9pt; COLOR: #008000">// is not empty</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">SrchRule =</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #2b91af">SearchRuleType</span><span style="COLOR: #000000">.Must,</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #000000">};</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none">&nbsp;</p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #2b91af"><span style="FONT-SIZE: 9pt">SrchCond</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">padlockProject =</span> <span style="COLOR: #0000ff">new</span> <span style="COLOR: #2b91af">SrchCond</span><span style="COLOR: #000000">()</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #000000">{</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">PropDefId = projectPropDef.Id,</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">PropTyp =</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #2b91af">PropertySearchType</span><span style="COLOR: #000000">.SingleProperty,</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">SrchOper = 3,</span></span> <span style="FONT-SIZE: 9pt; COLOR: #008000">// is equal</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">SrchRule =</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #2b91af">SearchRuleType</span><span style="COLOR: #000000">.Must,</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">SrchTxt =</span></span> <span style="FONT-SIZE: 9pt; COLOR: #a31515">"Padlock"</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #000000">};</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none">&nbsp;</p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">string</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">bookmark =</span> <span style="COLOR: #0000ff">string</span><span style="COLOR: #000000">.Empty;</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #2b91af"><span style="FONT-SIZE: 9pt">SrchStatus</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">status =</span> <span style="COLOR: #0000ff">null</span><span style="COLOR: #000000">;</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #2b91af"><span style="FONT-SIZE: 9pt">List</span></span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">&lt;</span><span style="COLOR: #2b91af">File</span><span style="COLOR: #000000">&gt; totalResults =</span> <span style="COLOR: #0000ff">new</span> <span style="COLOR: #2b91af">List</span><span style="COLOR: #000000">&lt;</span><span style="COLOR: #2b91af">File</span><span style="COLOR: #000000">&gt;();</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">while</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">(status ==</span> <span style="COLOR: #0000ff">null</span> <span style="COLOR: #000000">|| totalResults.Count &lt; status.TotalHits)</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #000000">{</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #2b91af">File</span> <span style="COLOR: #000000">[] results = m_svcMgr.DocumentService.FindFilesBySearchConditions(</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #0000ff">new</span> <span style="COLOR: #2b91af">SrchCond</span><span style="COLOR: #000000">[] { isCheckedOut, padlockProject },</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #0000ff">null</span><span style="COLOR: #000000">,</span> <span style="COLOR: #0000ff">null</span><span style="COLOR: #000000">,</span> <span style="COLOR: #0000ff">false</span><span style="COLOR: #000000">,</span> <span style="COLOR: #0000ff">true</span><span style="COLOR: #000000">,</span> <span style="COLOR: #0000ff">ref</span> <span style="COLOR: #000000">bookmark,</span> <span style="COLOR: #0000ff">out</span> <span style="COLOR: #000000">status);</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none">&nbsp;</p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #0000ff">if</span> <span style="COLOR: #000000">(results !=</span> <span style="COLOR: #0000ff">null</span><span style="COLOR: #000000">)</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <span style="FONT-SIZE: 9pt">totalResults.AddRange(results);</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt; COLOR: #0000ff">else</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt"><span style="COLOR: #0000ff">break</span><span style="COLOR: #000000">;</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #000000">}</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 8pt"><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #008000">// total results now has the results</span></span></span></p>
            </td>
        </tr>

        <tr>
            <td valign="top" width="470">
                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #008000">' VB.NET</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">Dim</span></span></span> <span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">filePropDefs</span> <span><span style="COLOR: #0000ff">As</span></span> <span style="COLOR: #000000">PropDef() = _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-spacerun: yes"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">m_svcMgr.PropertyService.GetPropertyDefinitionsByEntityClassId(</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: #a31515">"FILE"</span></span><span style="COLOR: #000000">)</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">Dim</span></span></span> <span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">checkedOutPropDef</span> <span><span style="COLOR: #0000ff">As</span></span> <span style="COLOR: #000000">PropDef = _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-spacerun: yes"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">filePropDefs.[Single](</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: #0000ff">Function</span></span><span style="COLOR: #000000">(n) n.SysName =</span> <span><span style="COLOR: #a31515">"CheckoutUserName"</span></span><span style="COLOR: #000000">)</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">Dim</span></span></span> <span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">projectPropDef</span> <span><span style="COLOR: #0000ff">As</span></span> <span style="COLOR: #000000">PropDef = _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-spacerun: yes"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">filePropDefs.[Single](</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: #0000ff">Function</span></span><span style="COLOR: #000000">(n) n.SysName =</span> <span><span style="COLOR: #a31515">"Project"</span></span><span style="COLOR: #000000">)</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none">&nbsp;</p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #008000">' SrchOper 5 =&gt; is not empty</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">Dim</span></span></span> <span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">isCheckedOut</span> <span><span style="COLOR: #0000ff">As</span></span> <span><span style="COLOR: #0000ff">New</span></span> <span style="COLOR: #000000">SrchCond()</span> <span><span style="COLOR: #0000ff">With</span></span> <span style="COLOR: #000000">{ _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">.PropDefId = checkedOutPropDef.Id, _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">.PropTyp = PropertySearchType.SingleProperty, _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">.SrchOper = 5, _</span><span style="mso-spacerun: yes"><span style="FONT-SIZE: 9pt">&nbsp;</span></span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">.SrchRule = SearchRuleType.Must _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #000000">}</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none">&nbsp;</p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #008000">' SrchOper 3 =&gt; equals</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">Dim</span></span></span> <span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">padlockProject</span> <span><span style="COLOR: #0000ff">As</span></span> <span><span style="COLOR: #0000ff">New</span></span> <span style="COLOR: #000000">SrchCond()</span> <span><span style="COLOR: #0000ff">With</span></span> <span style="COLOR: #000000">{ _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">.PropDefId = projectPropDef.Id, _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">.PropTyp = PropertySearchType.SingleProperty, _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">.SrchOper = 3, _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">.SrchRule = SearchRuleType.Must, _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">.SrchTxt =</span></span> <span style="FONT-SIZE: 9pt"><span><span style="COLOR: #a31515">"Padlock"</span></span> <span style="COLOR: #000000">_</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #000000">}</span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none">&nbsp;</p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">Dim</span></span></span> <span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">bookmark</span> <span><span style="COLOR: #0000ff">As</span></span> <span><span style="COLOR: #0000ff">String</span></span> <span style="COLOR: #000000">=</span> <span><span style="COLOR: #0000ff">String</span></span><span style="COLOR: #000000">.Empty</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">Dim</span></span></span> <span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">status</span> <span><span style="COLOR: #0000ff">As</span></span> <span style="COLOR: #000000">SrchStatus =</span></span> <span><span style="FONT-SIZE: 9pt; COLOR: #0000ff">Nothing</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">Dim</span></span></span> <span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">totalResults</span> <span><span style="COLOR: #0000ff">As</span></span> <span><span style="COLOR: #0000ff">New</span></span> <span style="COLOR: #000000">List(</span><span><span style="COLOR: #0000ff">Of</span></span> <span style="COLOR: #000000">File)()</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">While</span></span></span> <span><span style="FONT-SIZE: 9pt"><span style="COLOR: #000000">status</span> <span><span style="COLOR: #0000ff">Is</span></span> <span><span style="COLOR: #0000ff">Nothing</span></span> <span><span style="COLOR: #0000ff">OrElse</span></span> <span style="COLOR: #000000">totalResults.Count &lt; status.TotalHits</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="mso-tab-count: 1"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span> <span style="FONT-SIZE: 9pt"><span><span style="COLOR: #0000ff">Dim</span></span> <span style="COLOR: #000000">results</span> <span><span style="COLOR: #0000ff">As</span></span> <span style="COLOR: #000000">File() = _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt"><span style="mso-spacerun: yes">&nbsp;&nbsp;</span> m_svcMgr.DocumentService.FindFilesBySearchConditions( _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span></span></span> <span style="FONT-SIZE: 9pt"><span><span style="COLOR: #0000ff">New</span></span> <span style="COLOR: #000000">SrchCond() {isCheckedOut, padlockProject}, _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 1"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span></span></span> <span style="FONT-SIZE: 9pt"><span><span style="COLOR: #0000ff">Nothing</span></span><span style="COLOR: #000000">,</span> <span><span style="COLOR: #0000ff">Nothing</span></span><span style="COLOR: #000000">,</span> <span><span style="COLOR: #0000ff">False</span></span><span style="COLOR: #000000">,</span> <span><span style="COLOR: #0000ff">True</span></span><span style="COLOR: #000000">, bookmark, _</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 2"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">status)</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none">&nbsp;</p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="mso-tab-count: 1"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span> <span style="FONT-SIZE: 9pt"><span><span style="COLOR: #0000ff">If</span></span> <span style="COLOR: #000000">results</span> <span><span style="COLOR: #0000ff">IsNot</span></span> <span><span style="COLOR: #0000ff">Nothing</span></span> </span><span><span style="FONT-SIZE: 9pt; COLOR: #0000ff">Then</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: #000000"><span style="mso-tab-count: 2"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span> <span style="FONT-SIZE: 9pt">totalResults.AddRange(results)</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="mso-tab-count: 1"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span> <span><span style="FONT-SIZE: 9pt; COLOR: #0000ff">Else</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="mso-tab-count: 2"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span> <span><span style="FONT-SIZE: 9pt; COLOR: #0000ff">Exit While</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="mso-tab-count: 1"><span style="COLOR: #000000"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span> <span style="FONT-SIZE: 9pt"><span><span style="COLOR: #0000ff">End</span></span> </span><span><span style="FONT-SIZE: 9pt; COLOR: #0000ff">If</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: #0000ff"><span style="FONT-SIZE: 9pt">End</span></span></span> <span><span><span style="FONT-SIZE: 9pt; COLOR: #0000ff">While</span></span></span></span></p>

                <p class="MsoNormal" style="MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: #008000">' total results now has the results</span></span></span></p>
            </td>
        </tr>
    </tbody>
</table>

<p></p>

<p>The code is running the same search from the screenshot at the top of the article.&nbsp; In this case, I want to gather all results, even if it’s bigger than the page size.&nbsp; I put the Find call in a while loop so that I can keep going, page by page, until I get all the results.</p>
<hr style="COLOR: #5acb04" noshade="noshade" />

<p><strong>Search Conditions&nbsp;<br /></strong> The <a href="topic5434.html">SrchCond</a> objects are the main building blocks of your search.&nbsp; Each object defines a single condition in the search.&nbsp; A condition consists of a property, a condition and a value.&nbsp; For example, “<span style="TEXT-DECORATION: underline">Author</span> <span style="TEXT-DECORATION: underline">is</span> <span style="TEXT-DECORATION: underline">Doug</span>” or “<span style="TEXT-DECORATION: underline">CreateDate</span> <span style="TEXT-DECORATION: underline">is less than</span> <span style="TEXT-DECORATION: underline">6/31/2011</span>”.&nbsp; Value may not be used in some cases depending on the condition.&nbsp; For example, “<span style="TEXT-DECORATION: underline">Checked Out By</span> <span style="TEXT-DECORATION: underline">is not empty</span>”.&nbsp;</p>

<p>The <a href="topic677.html">PropTyp</a> property basically determines if this is an advanced search or a basic search.&nbsp; “SingleProperty” means advanced search because the value only relates to a single property.&nbsp; “AllProperties” and “AllPropertiesAndContent” both refer to the basic search feature where a single value is compared against all properties.</p>

<p>SrchOper defines the comparison operator, such as “equals” or “less than”.&nbsp; It’s a number, and the SDK documentation has a table of all the legal values.</p>

<p><a href="http://justonesandzeros.typepad.com/blog/2010/12/may-and-must-search-rules.html" target="_blank"><font color="#0066CC">Search Rule</font></a> is something I covered in another article, so I won’t go over it here.&nbsp; The advanced find command in the Vault client always uses Must, which means there is an AND relationship between the conditions.</p>
<hr style="COLOR: #5acb04" noshade="noshade" />

<p><strong>FindFilesBySearchConditions</strong><br />
Here is the function itself.&nbsp; I won’t be going over every parameter, but I will make sure to cover the tricky ones.</p>

<p>File[] FindFilesBySearchConditions(<br />
&nbsp;&nbsp; SrchCond[] conditions,<br />
&nbsp;&nbsp; SrchSort[] sortConditions,<br />
&nbsp;&nbsp; long[] folderIds,<br />
&nbsp;&nbsp; bool recurseFolders,<br />
&nbsp;&nbsp; bool latestOnly,<br />
&nbsp;&nbsp; ref System.string bookmark,<br />
&nbsp;&nbsp; out SrchStatus searchstatus<br />
)</p>

<p>The first parameter is the array of <strong>search conditions</strong>.&nbsp; You can pass in an empty array, which results in all Files being returned.&nbsp; It’s actually the <a href="http://justonesandzeros.typepad.com/blog/2011/03/coding-for-performance-getting-all-files.html" target="_blank"><font color="#0066CC">most efficient way to scan through all the files in the Vault</font></a>.</p>

<p>Next is the array of <strong>sort</strong> objects.&nbsp; You can pass in null if you don’t care about the order.&nbsp; If you do want a sort, the <a href="topic5445.html">SrchSort</a> class is pretty straightforward.&nbsp; It’s a Vault property you want to sort on, and you can have it be ascending or descending.&nbsp; The input is an array so that you can sort across multiple properties.&nbsp; The first object in the array is a primary sort, the second object is the secondary sort, and so on.</p>

<p><strong>FolderIds</strong> is for cases where you want to search in a specific set of folders.&nbsp; If you want to search the whole Vault, pass in null.&nbsp; Passing in the root folder may slow performance.</p>

<p><strong>Bookmark</strong> is for when you need multiple pages returned.&nbsp; The first time you call Find, you pass in an empty string for the bookmark.&nbsp; If you don’t get all the results in the first call, bookmark will get updated.&nbsp; You can then use the bookmark for the next call and it will continue the search from where the last search left off.</p>

<p><strong>Search Status</strong> lets you know how many total results there are.&nbsp; It also lets you know if a re-index is going on.&nbsp; In the event of a re-index, your results may not be 100% accurate.&nbsp; There is not much you can do in this case aside from warning the user.</p><!--DXMETADATA end-->
            <a name="seealsobookmark"></a>
            <!--DXMETADATA start type="FilteredItemList" scrap="CATEGORISED_LINKS" namespace="linkcategory" source="Item" filter="" NoHeader="True" NoFooter="True" format="%%replaceinquotes:value=false%%%%scrap:name=_COLLAPSIBLE_HEADER,idprefix=seealso,caption=""%%phrase:name=SeeAlso%%%%designlist:tagidentifier=seealso,itemtype=See Also%%""%%%%filtereditemlist%%</div>"--><!--DXMETADATA end-->
        </div>
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_FOOTER" --><!--DXMETADATA end -->
        <div id="pagefooter">
            <!--DXMETADATA start type="Variable" name="CopyrightNotice" format="<p>&nbsp;</p><p>&nbsp;</p><hr style=""height: 1px"" /><p>%%variable%%</p>" --><!--DXMETADATA end -->
        </div>
        <!--DXMETADATA start type="FeedbackSection" --><!--DXMETADATA end -->
    </div>
    <!--DXMETADATA start type="Variable" name="NonScrollingPageFooter" format="<div id=nonscrollingpagefooter>%%variable%%</div>" --><div id=nonscrollingpagefooter>&copy;2025. All Rights Reserved.</div><!--DXMETADATA end -->
</body>
</html>