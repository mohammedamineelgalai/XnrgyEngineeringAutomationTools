<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:innovasys xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
    <!--DXMETADATA start type="MetaCharset" --><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"><!--DXMETADATA end-->
    <meta content="history" name="save" />
    <meta name="GENERATOR" content="Innovasys HelpStudio (http://www.innovasys.com)" />
    <!--DXMETADATA start type="ItemTitle" format="<title>%%ItemTitle%%</title>" --><title>Extension Loading Error Logging</title><!--DXMETADATA end-->
    <link rel="stylesheet" type="text/css" href="stylesheets/helpstudio.css" />
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/community.css"">" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="Literal" condition="helpversion:value=2" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/help2.css"">" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Stylesheets" --><link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-heading-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-tabstrip.css"></link><!--DXMETADATA end-->
    <script src="script/helpstudio.js" type="text/javascript"></script>
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<script src=""script/community.js""></script>" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Scripts" --><script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="Variable" name="BannerColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {background-color: %%Variable%%}</style>" blankformat="" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Variable" name="BannerTextColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {color: %%Variable:Name=BannerTextColor%%}</style>" blankformat="" --><!--DXMETADATA end -->
	<!--DXMETADATA start type="Variable" name="TopicXMLIsland" condition="helpversion:value=2" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="DesignTime" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CanonicalLink" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CustomHeadContent" --><!--DXMETADATA end-->
</head>
<body id="hsbody">
	<!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_PROPERTIES" --><!--DXMETADATA end -->
    <div style="display: none">
        <input type="hidden" id="userDataCache" class="userDataStyle" name="userDataCache" />
        <input type="hidden" id="hiddenScrollOffset" name="hiddenScrollOffset" />
    </div>
    <img id="collapseImage" style="display:none; height:0; width:0;" src="images/collapse.gif">
    <img id="expandImage" style="display:none; height:0; width:0;" src="images/expand.gif"/>
    <img id="copyImage" style="display:none; height:0; width:0;" src="images/copycode.gif"/>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="images/copycodeHighlight.gif">
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="images/drpdown.gif"/>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="images/drpdown_orange.gif"/>
    <div id="pagetop">
        <!--DXMETADATA start type="DesignBanner" --><!--DXMETADATA end -->
        <table width="100%" id="pagetoptable2" cellspacing="0" cellpadding="0">
        	<tr>
        		<td><!--DXMETADATA start type="Literal" condition="communityenabled" value="%%scrap:name=_COMMUNITY_RATING%%%%scrap:name=_COMMUNITY_DROPDOWN%%" --><!--DXMETADATA end --></td>
        	</tr>
        </table>
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">
                        <!--DXMETADATA start type="ProjectTitle" -->Vault SDK<!--DXMETADATA end-->
                    </span>
                </td>
                <td align="right" rowspan="2">
                    <!--DXMETADATA start type="LogoImage" --><!--DXMETADATA end-->
                </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left">
                    <span id="pagetitle">
                        <!--DXMETADATA start type="ItemTitle" -->Extension Loading Error Logging<!--DXMETADATA end-->
                    </span>
                </td>
            </tr>
            <tr id="pagetoptable1row3">
            	<td colspan="2">
            		<!--DXMETADATA start type="Literal" condition="childitems:itemtype=linkcategory" value="<a href=""#seealsobookmark"">%%Phrase:Name=SeeAlso,BlankFormat=See Also%%</a>" --><a href="#seealsobookmark">See Also</a><!--DXMETADATA end -->
            		<span id="feedbacklink"><!--DXMETADATA start type="Variable" name="FeedbackLink" format="" --><a href="http://forums.autodesk.com/t5/vault-customization/bd-p/301 " rel="noopener noreferrer" target="_blank">Send Feedback</a><!--DXMETADATA end --></span>
            	</td>
            </tr>
        </table>
        <!--DXMETADATA start type="Breadcrumbs" scrap="_BREADCRUMBS" --><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="topic46.html">Knowledge Base</a>
 > Extension Loading Error Logging</td></tr></table><!--DXMETADATA end -->
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_MENU" --><!--DXMETADATA end -->
    </div>
    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>
    <div id="pagebody">
        <div id="mainbody">
<!--DXMETADATA start type="TopicSection" name="BodyText"--><p class="MsoNormalCxSpMiddle" style="LINE-HEIGHT: normal">By Dan Dulzo<br /></p>

<p class="MsoNormalCxSpMiddle" style="LINE-HEIGHT: normal">Sometimes, Vault extensions are loaded into environments without a GUI, such as an <a href="topic16.html">event handler</a>. Unfortunately, if the extension fails to load due to errors such as the ones found <a href="http://justonesandzeros.typepad.com/blog/2011/05/extension-deployment-checklist.html" target="_blank">here</a>, it will fail silently. As an SDK programmer, this can cause confusion when trying to develop and deploy an extension. Fortunately, the SDK can be configured to log these errors, allowing developers to see (and hopefully fix) what went wrong when loading an extension.</p>

<p class="MsoNormalCxSpMiddle" style="LINE-HEIGHT: normal"><strong>Configuring Logging</strong></p>

<p class="MsoNormalCxSpMiddle" style="LINE-HEIGHT: normal">To enable logging, deploy an xml file named ExtensionLogConfig.xml to the same directory that extensions are deployed to (C:\Program Data\Autodesk\Vault 2013\Extensions). Upon loading an extension, this directory is checked for the configuration file, and if it is found, logging is enabled. The ExtensionLogConfig.xml file has a pretty simple format. An example can be seen below.</p>

<p class="MsoNormalCxSpMiddle" style="LINE-HEIGHT: normal">&nbsp;</p>

<div id="Syntax_XML" class="LanguageSpecific" data-title="XML" data-itemid="XML">
    <table class="syntaxtable" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th class="codeboxtitlecell">ExtensionLogConfig.xml</th>

                <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
            </tr>

            <tr>
                <td colspan="2">
                    <pre>
<span style="COLOR: #0000ff">&lt;?</span><span style="COLOR: #ff00ff">xml version="1.0"</span><span style="COLOR: #0000ff">?&gt;</span>
<span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">ExtensionLoggerConfiguration</span><span style="COLOR: #0000ff">&gt;</span>
  <span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">BaseFileName</span><span style="COLOR: #0000ff">&gt;</span>C:\ProgramData\Autodesk\Vault 2013\Extensions\ExtensionLog_<span style="COLOR: #0000ff">&lt;/</span><span style="COLOR: #800000">BaseFileName</span><span style="COLOR: #0000ff">&gt;</span>
  <span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">DateFormat</span><span style="COLOR: #0000ff">&gt;</span>_yyyyMMdd<span style="COLOR: #0000ff">&lt;/</span><span style="COLOR: #800000">DateFormat</span><span style="COLOR: #0000ff">&gt;</span>
  <span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">KeepLogsFor</span><span style="COLOR: #0000ff">&gt;</span>1<span style="COLOR: #0000ff">&lt;/</span><span style="COLOR: #800000">KeepLogsFor</span><span style="COLOR: #0000ff">&gt;</span>
  <span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">FileExtension</span><span style="COLOR: #0000ff">&gt;</span>.txt<span style="COLOR: #0000ff">&lt;/</span><span style="COLOR: #800000">FileExtension</span><span style="COLOR: #0000ff">&gt;</span>
<span style="COLOR: #0000ff">&lt;/</span><span style="COLOR: #800000">ExtensionLoggerConfiguration</span><span style="COLOR: #0000ff">&gt;</span>
</pre>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">The BaseFileName element specifies the location of the output log file, as well as the base file name of the file. The DateFormat element tells the logger the how to format the date when appending it to the log file name. The KeepLogsFor sets the number of days to keep log files for. The logger will attempt to automatically delete log files with a date older than the specified number of days. Using a value of -1 will cause the logger to delete any previous log information each time an extension attempts to load. Finally, the FileExtension element is used to specify the file extension to use for the log files.</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<div style="WIDTH: 100%">
    <table class="hs-box">
        <tbody>
            <tr>
                <td class="hs-box-icon" valign="top"><img src="images/hs-note.gif" /></td>

                <td class="hs-box-content" valign="top">
                    <p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">Note: If there are no extensions to load, logging will not be performed regardless of any configuration file.&nbsp;&nbsp;Also, if the configuration file cannot be read due to&nbsp;being malformed or any other reason, logging will not be enabled.</p>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">The logger will write out what extensions load successfully and various error messages for extensions that failed to load. Most errors will result in a descriptive message getting&nbsp;written to the error log.&nbsp;Problems such&nbsp;as having incorrect assembly attributes or missing a public&nbsp;contructor for your extension&nbsp;class&nbsp;should be easy to identify when reading the log.&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none"><strong>Common Problems</strong></p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">Unfortunately, the logger will not be able to provide a useful message in&nbsp;certain situations when the extension&nbsp;loader doesn't know enough about why an extension failed to load. In these cases, the log will contain a&nbsp;generic message&nbsp;resembling "Could not load file or assembly..." or sometimes no message at all. Below are some descriptions of&nbsp;common problems&nbsp;and likely solutions to a few situations where the logger will be unable to provide specific information about why an extension failed to load.</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none"><em>Problem 1: No&nbsp;log file is created</em></p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">If an extension is failing to load and there is no log file being created, double-check that your ExtensionLogConfig.xml file is properly&nbsp;formatted xml. Ensure that the configuration file has appropriate values for all of the configuration settings, i.e. the complete file name is valid, DateFormat is an appropriate date format string, Vault has permision to create files in the directory specified in BaseFileName, etc. Next, check that the ExtensionLogConfig.xml has been deployed to the correct directory. A common mistake here is deploying an ExtensionLogConfig.xml file to each extension's directory. There should&nbsp;be only one&nbsp;configuration file and it should&nbsp;be deployed to the Extensions directory(C:\Program Data\Autodesk\Vault 2013\Extensions\ExtensionLogConfig.xml),&nbsp;NOT to a specific extension's directory (C:\Program Data\Autodesk\Vault 2013\Extensions\[Some Extension's Name]\ExtensionLogConfig.xml). Finaly, check to make sure at least one extension is configured to load because no log file is created if there will be nothing to log.</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none"><em>Problem 2:&nbsp;An extension failed to load but there is nothing about the failed extension&nbsp;in the log file</em></p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">There log file will always output messages for extensions that successfully load and extensions that try to load. If there are no message of an extension in the log file, it essentially means that Vault is unaware of the extension, and in fact, didn't even try to load it. The key thing to check in this situation is the .vcet.config file that is supposed to be deployed along with each extension. Make sure this file has the&nbsp;right name,&nbsp;is well formed, contains all the necessary information about the extension, and is in the correct directory. It's important to remember that the .vcet.config file is what lets Vault know of each extension to load. Another issue to check is that all extension files are deployed to the correct directory as well.</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none"><em>Problem 3: The log contains the vague error message of "Could not load file or assembly..."</em></p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">&nbsp;</p>

<p class="MsoNormalCxSpMiddle" style="MARGIN-BOTTOM: 0pt; LINE-HEIGHT: normal; mso-add-space: auto; mso-layout-grid-align: none">For whatever reason, the extension loader could not load some sort of file or assembly referenced by an extesion. The most common root cause of this message is that something is missing. Usually, the first thing to check is that all assemblies referenced by an extension are deployed along-side it (unless they are available in the GAC). Please note that certain SDK assemblies referenced by an extension do not need to be deployed with each extension because they are already loaded by Vault. Another possible&nbsp;cause is that the failed extension references the wrong version of the SDK assemblies, so be sure to check this as well.&nbsp;</p>

<p>&nbsp;</p><!--DXMETADATA end-->
            <a name="seealsobookmark"></a>
            <!--DXMETADATA start type="FilteredItemList" scrap="CATEGORISED_LINKS" namespace="linkcategory" source="Item" filter="" NoHeader="True" NoFooter="True" format="%%replaceinquotes:value=false%%%%scrap:name=_COLLAPSIBLE_HEADER,idprefix=seealso,caption=""%%phrase:name=SeeAlso%%%%designlist:tagidentifier=seealso,itemtype=See Also%%""%%%%filtereditemlist%%</div>"--><h1 class="heading"><span class="expandcollapse" tabindex="0"><img id="seealsoToggle" class="toggle" name="toggleSwitch" src="images/collapse.gif"></img>See Also</span></h1><div id="seealsoSection" class="section" name="collapseableSection"><p><b>Getting Started</b><br /><a href="topic14.html">How to customize Vault Explorer</a>
<br /><a href="topic16.html">How to handle events</a>
<br /><a href="topic15.html">How to Create Custom Jobs</a>
</p>
</div><!--DXMETADATA end-->
        </div>
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_FOOTER" --><!--DXMETADATA end -->
        <div id="pagefooter">
            <!--DXMETADATA start type="Variable" name="CopyrightNotice" format="<p>&nbsp;</p><p>&nbsp;</p><hr style=""height: 1px"" /><p>%%variable%%</p>" --><!--DXMETADATA end -->
        </div>
        <!--DXMETADATA start type="FeedbackSection" --><!--DXMETADATA end -->
    </div>
    <!--DXMETADATA start type="Variable" name="NonScrollingPageFooter" format="<div id=nonscrollingpagefooter>%%variable%%</div>" --><div id=nonscrollingpagefooter>&copy;2025. All Rights Reserved.</div><!--DXMETADATA end -->
</body>
</html>