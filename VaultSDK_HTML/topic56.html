<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:innovasys xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
    <!--DXMETADATA start type="MetaCharset" --><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"><!--DXMETADATA end-->
    <meta content="history" name="save" />
    <meta name="GENERATOR" content="Innovasys HelpStudio (http://www.innovasys.com)" />
    <!--DXMETADATA start type="ItemTitle" format="<title>%%ItemTitle%%</title>" --><title>Event Scope</title><!--DXMETADATA end-->
    <link rel="stylesheet" type="text/css" href="stylesheets/helpstudio.css" />
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/community.css"">" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="Literal" condition="helpversion:value=2" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/help2.css"">" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Stylesheets" --><link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-heading-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-tabstrip.css"></link><!--DXMETADATA end-->
    <script src="script/helpstudio.js" type="text/javascript"></script>
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<script src=""script/community.js""></script>" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Scripts" --><script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="Variable" name="BannerColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {background-color: %%Variable%%}</style>" blankformat="" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Variable" name="BannerTextColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {color: %%Variable:Name=BannerTextColor%%}</style>" blankformat="" --><!--DXMETADATA end -->
	<!--DXMETADATA start type="Variable" name="TopicXMLIsland" condition="helpversion:value=2" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="DesignTime" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CanonicalLink" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CustomHeadContent" --><!--DXMETADATA end-->
</head>
<body id="hsbody">
	<!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_PROPERTIES" --><!--DXMETADATA end -->
    <div style="display: none">
        <input type="hidden" id="userDataCache" class="userDataStyle" name="userDataCache" />
        <input type="hidden" id="hiddenScrollOffset" name="hiddenScrollOffset" />
    </div>
    <img id="collapseImage" style="display:none; height:0; width:0;" src="images/collapse.gif">
    <img id="expandImage" style="display:none; height:0; width:0;" src="images/expand.gif"/>
    <img id="copyImage" style="display:none; height:0; width:0;" src="images/copycode.gif"/>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="images/copycodeHighlight.gif">
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="images/drpdown.gif"/>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="images/drpdown_orange.gif"/>
    <div id="pagetop">
        <!--DXMETADATA start type="DesignBanner" --><!--DXMETADATA end -->
        <table width="100%" id="pagetoptable2" cellspacing="0" cellpadding="0">
        	<tr>
        		<td><!--DXMETADATA start type="Literal" condition="communityenabled" value="%%scrap:name=_COMMUNITY_RATING%%%%scrap:name=_COMMUNITY_DROPDOWN%%" --><!--DXMETADATA end --></td>
        	</tr>
        </table>
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">
                        <!--DXMETADATA start type="ProjectTitle" -->Vault SDK<!--DXMETADATA end-->
                    </span>
                </td>
                <td align="right" rowspan="2">
                    <!--DXMETADATA start type="LogoImage" --><!--DXMETADATA end-->
                </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left">
                    <span id="pagetitle">
                        <!--DXMETADATA start type="ItemTitle" -->Event Scope<!--DXMETADATA end-->
                    </span>
                </td>
            </tr>
            <tr id="pagetoptable1row3">
            	<td colspan="2">
            		<!--DXMETADATA start type="Literal" condition="childitems:itemtype=linkcategory" value="<a href=""#seealsobookmark"">%%Phrase:Name=SeeAlso,BlankFormat=See Also%%</a>" --><!--DXMETADATA end -->
            		<span id="feedbacklink"><!--DXMETADATA start type="Variable" name="FeedbackLink" format="" --><a href="http://forums.autodesk.com/t5/vault-customization/bd-p/301 " rel="noopener noreferrer" target="_blank">Send Feedback</a><!--DXMETADATA end --></span>
            	</td>
            </tr>
        </table>
        <!--DXMETADATA start type="Breadcrumbs" scrap="_BREADCRUMBS" --><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="topic46.html">Knowledge Base</a>
 > Event Scope</td></tr></table><!--DXMETADATA end -->
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_MENU" --><!--DXMETADATA end -->
    </div>
    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>
    <div id="pagebody">
        <div id="mainbody">
<!--DXMETADATA start type="TopicSection" name="BodyText"--><p>by Doug Redmond, It's All Just Ones and Zeros<a href="http://justonesandzeros.typepad.com/" target="_blank"></a><br />
07/22/2011</p><br />

<p>Although the web service events feature was designed to hook to all Vault clients on a computer, it doesn't meant that it is <em>required</em> to hook to them all.&nbsp; Sometimes you want to hook to an event for just one application, and that's fine too.</p>

<p>I'll refer to the <strong>scope</strong> of the event as the set of applications that you are interested in receiving events from.</p>
<hr />

<p><strong>Scenario 1:&nbsp; Global scope</strong></p>

<p>If you want to get events from all Vault clients on a computer, you can follow the instructions in the SDK documentation.&nbsp; The <a href="topic16.html">Web Service Command Events</a> page in the Getting Started section goes over all the details.&nbsp; Here is a basic summary:</p>

<ol>
    <li>Create a DLL project.</li>

    <li>Create a class that implements the IWebServiceExtension interface.</li>

    <li>Subscribe to events in the OnLoad() function.</li>

    <li>Write your event handler logic.</li>

    <li>Set your &lt;extensionType&gt; to WebService in the .vcet.config file.</li>

    <li>Deploy to the ProgramData folder.</li>
</ol>
<hr />

<p><strong>Scenario 2:&nbsp; Vault Explorer scope</strong></p>

<p>Let's say you only care about events within your Vault Explorer plug-in.&nbsp; For example, you have a custom command or tab view that needs to know about these events.&nbsp; The steps are different in this case:</p>

<ol>
    <li>Open up the DLL project for your Vault Extension.</li>

    <li>Do not implement the IWebServiceExtension interface.</li>

    <li>Subscribe to events in the OnStartup() function for your IExplorerExtension implmentation.</li>

    <li>Write your event handler logic.</li>

    <li>Your &lt;extensionType&gt; is still VaultClient in the .vcet.config file.&nbsp; No changes or additions are needed.</li>

    <li>Deployment is still to the ProgramData folder.&nbsp; Again, no changes.</li>
</ol>
<hr />

<p><strong>Scenario 3:&nbsp; CAD application scope using a plug-in</strong></p>

<p>If you are plugging into a CAD app, the steps are very similar to scenario 2.&nbsp; The main difference is that your plug-in will have a different set of rules on how to set up and deploy.&nbsp; Here are the steps, at a high level:</p>

<ol>
    <li>Open up the project for your CAD plug-in.</li>

    <li>Do not implement the IWebServiceExtension interface.</li>

    <li>During startup, subscribe to the web service events from the Vault API.&nbsp; This assumes that the CAD API framework lets your code run during startup.</li>

    <li>Write your event handler logic.</li>

    <li>Deploy according to the rules of the CAD framework.</li>
</ol>

<p>This technique will allow you to hook to all the Vault web service events for that CAD application, even if another plug-in fired them.&nbsp; For example, you can write your own AutoCAD plug-in which responds to events from the default Vault plug-in.</p>
<hr />

<p><strong>Scenario 4:&nbsp; "Application X" scope without using a plug-in</strong></p>

<p>If you want to scope your event to an application, but you can't write a plug-in, there is still an option.&nbsp; All you need to do is follow scenario 1.&nbsp; In step 4, when you are writing your event handler logic, check the name of the running process.&nbsp; If it's not an application you want events from, exit the function.</p>

<p>There is no perfect way I know of to get the name of the current process.&nbsp; The safest ways is probably to can use the first value from System.Environment.GetCommandLineArgs() to find the application name.&nbsp; You can also use System.Diagnostics.Process.GetCurrentProcess().ProcessName, but it might throw security exceptions depending on the user permissions.&nbsp; System.Windows.Forms.Application.ExecutablePath is also unreliable because it only works for Windowed applications.</p>

<p>The nice thing about this technique is that you can allow multiple applications.&nbsp; Or you could use it to <em>exclude</em> specific applications.&nbsp; For example, you exit the event handler if the application name is "JobProcessor.exe".</p>

<p>&nbsp;</p><!--DXMETADATA end-->
            <a name="seealsobookmark"></a>
            <!--DXMETADATA start type="FilteredItemList" scrap="CATEGORISED_LINKS" namespace="linkcategory" source="Item" filter="" NoHeader="True" NoFooter="True" format="%%replaceinquotes:value=false%%%%scrap:name=_COLLAPSIBLE_HEADER,idprefix=seealso,caption=""%%phrase:name=SeeAlso%%%%designlist:tagidentifier=seealso,itemtype=See Also%%""%%%%filtereditemlist%%</div>"--><!--DXMETADATA end-->
        </div>
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_FOOTER" --><!--DXMETADATA end -->
        <div id="pagefooter">
            <!--DXMETADATA start type="Variable" name="CopyrightNotice" format="<p>&nbsp;</p><p>&nbsp;</p><hr style=""height: 1px"" /><p>%%variable%%</p>" --><!--DXMETADATA end -->
        </div>
        <!--DXMETADATA start type="FeedbackSection" --><!--DXMETADATA end -->
    </div>
    <!--DXMETADATA start type="Variable" name="NonScrollingPageFooter" format="<div id=nonscrollingpagefooter>%%variable%%</div>" --><div id=nonscrollingpagefooter>&copy;2025. All Rights Reserved.</div><!--DXMETADATA end -->
</body>
</html>