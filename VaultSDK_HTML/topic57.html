<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:innovasys xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
    <!--DXMETADATA start type="MetaCharset" --><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"><!--DXMETADATA end-->
    <meta content="history" name="save" />
    <meta name="GENERATOR" content="Innovasys HelpStudio (http://www.innovasys.com)" />
    <!--DXMETADATA start type="ItemTitle" format="<title>%%ItemTitle%%</title>" --><title>Web Service Command Event - FAQ</title><!--DXMETADATA end-->
    <link rel="stylesheet" type="text/css" href="stylesheets/helpstudio.css" />
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/community.css"">" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="Literal" condition="helpversion:value=2" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/help2.css"">" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Stylesheets" --><link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-heading-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-tabstrip.css"></link><!--DXMETADATA end-->
    <script src="script/helpstudio.js" type="text/javascript"></script>
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<script src=""script/community.js""></script>" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Scripts" --><script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="Variable" name="BannerColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {background-color: %%Variable%%}</style>" blankformat="" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Variable" name="BannerTextColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {color: %%Variable:Name=BannerTextColor%%}</style>" blankformat="" --><!--DXMETADATA end -->
	<!--DXMETADATA start type="Variable" name="TopicXMLIsland" condition="helpversion:value=2" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="DesignTime" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CanonicalLink" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CustomHeadContent" --><!--DXMETADATA end-->
</head>
<body id="hsbody">
	<!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_PROPERTIES" --><!--DXMETADATA end -->
    <div style="display: none">
        <input type="hidden" id="userDataCache" class="userDataStyle" name="userDataCache" />
        <input type="hidden" id="hiddenScrollOffset" name="hiddenScrollOffset" />
    </div>
    <img id="collapseImage" style="display:none; height:0; width:0;" src="images/collapse.gif">
    <img id="expandImage" style="display:none; height:0; width:0;" src="images/expand.gif"/>
    <img id="copyImage" style="display:none; height:0; width:0;" src="images/copycode.gif"/>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="images/copycodeHighlight.gif">
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="images/drpdown.gif"/>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="images/drpdown_orange.gif"/>
    <div id="pagetop">
        <!--DXMETADATA start type="DesignBanner" --><!--DXMETADATA end -->
        <table width="100%" id="pagetoptable2" cellspacing="0" cellpadding="0">
        	<tr>
        		<td><!--DXMETADATA start type="Literal" condition="communityenabled" value="%%scrap:name=_COMMUNITY_RATING%%%%scrap:name=_COMMUNITY_DROPDOWN%%" --><!--DXMETADATA end --></td>
        	</tr>
        </table>
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">
                        <!--DXMETADATA start type="ProjectTitle" -->Vault SDK<!--DXMETADATA end-->
                    </span>
                </td>
                <td align="right" rowspan="2">
                    <!--DXMETADATA start type="LogoImage" --><!--DXMETADATA end-->
                </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left">
                    <span id="pagetitle">
                        <!--DXMETADATA start type="ItemTitle" -->Web Service Command Event - FAQ<!--DXMETADATA end-->
                    </span>
                </td>
            </tr>
            <tr id="pagetoptable1row3">
            	<td colspan="2">
            		<!--DXMETADATA start type="Literal" condition="childitems:itemtype=linkcategory" value="<a href=""#seealsobookmark"">%%Phrase:Name=SeeAlso,BlankFormat=See Also%%</a>" --><!--DXMETADATA end -->
            		<span id="feedbacklink"><!--DXMETADATA start type="Variable" name="FeedbackLink" format="" --><a href="http://forums.autodesk.com/t5/vault-customization/bd-p/301 " rel="noopener noreferrer" target="_blank">Send Feedback</a><!--DXMETADATA end --></span>
            	</td>
            </tr>
        </table>
        <!--DXMETADATA start type="Breadcrumbs" scrap="_BREADCRUMBS" --><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="topic46.html">Knowledge Base</a>
 > Web Service Command Event - FAQ</td></tr></table><!--DXMETADATA end -->
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_MENU" --><!--DXMETADATA end -->
    </div>
    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>
    <div id="pagebody">
        <div id="mainbody">
<!--DXMETADATA start type="TopicSection" name="BodyText"--><p>by Doug Redmond, It's All Just Ones and Zeros<a href="http://justonesandzeros.typepad.com/" target="_blank"></a><br />
04/08/2011</p>

<p>&nbsp;</p>

<p><strong>What is the Event feature in the Vault 2012 API?<br /></strong> For Vault 2012, a feature was added called <strong>Web Service Command Events</strong>, which allows you to run custom code before and after certain Vault operations are executed.&nbsp; For example, you can perform custom operations after a file gets checked-in.</p>

<p><strong><br />
What is the scope of my event handlers?<br /></strong> Your handlers will hook to any application on that computer using Autodesk.Connectivity.WebServices.dll.&nbsp; Starting in Vault 2012 all Autodesk Vault clients use this DLL for communication with the server.&nbsp; So you can hook to applications like Vault Explorer, AutoCAD, Inventor, Civil 3D, and so on.<br />
<br />
Let me restate, that this feature runs <strong>client side</strong>.&nbsp; So if you have 100 Vault users, your event code needs to be deployed to 100 computers in order to grab all events.</p>

<p><strong><br />
What Vault products does this feature work with?<br /></strong> Vault Workgroup, Vault Collaboration and Vault Professional.&nbsp; It is not available in base Vault.</p>

<p><strong><br />
What operations can I receive events for?<br /></strong> Most events can be displayed in a grid:</p>

<p></p>

<table cellspacing="0" cellpadding="2" width="450" border="1">
    <tbody>
        <tr>
            <td valign="top" width="90">&nbsp;</td>

            <td valign="top" width="90">File</td>

            <td valign="top" width="90">Folder</td>

            <td valign="top" width="90">Item</td>

            <td valign="top" width="90">Change Order</td>
        </tr>

        <tr>
            <td valign="top" width="90">Add</td>

            <td valign="top" width="90">Yes</td>

            <td valign="top" width="90">Yes</td>

            <td valign="top" width="90">Yes</td>

            <td valign="top" width="90">Yes</td>
        </tr>

        <tr>
            <td valign="top" width="90">Delete</td>

            <td valign="top" width="90">Yes</td>

            <td valign="top" width="90">Yes</td>

            <td valign="top" width="90">Yes</td>

            <td valign="top" width="90">Yes</td>
        </tr>

        <tr>
            <td valign="top" width="90">Reserve for editing</td>

            <td valign="top" width="90">Yes (checkout)</td>

            <td valign="top" width="90">No</td>

            <td valign="top" width="90">Yes<br />
            (edit)</td>

            <td valign="top" width="90">Yes<br />
            (edit)</td>
        </tr>

        <tr>
            <td valign="top" width="90">Commit Changes</td>

            <td valign="top" width="90">Yes<br />
            (checkin)</td>

            <td valign="top" width="90">No</td>

            <td valign="top" width="90">Yes<br />
            (commit)</td>

            <td valign="top" width="90">Yes<br />
            (commit)</td>
        </tr>

        <tr>
            <td valign="top" width="90">Change Lifecycle</td>

            <td valign="top" width="90">Yes</td>

            <td valign="top" width="90">No</td>

            <td valign="top" width="90">Yes</td>

            <td valign="top" width="90">Yes</td>
        </tr>
    </tbody>
</table>

<p></p>

<p>In addition to the ones listed in the grid, you can receive events for File Download, Item Rollback Lifecycle, and Item Promote.</p>

<p><strong><br />
What are the events I can hook to for a given operation?<br /></strong> Each operation fires 3 events:</p>

<ol>
    <li><strong>GetRestrictions</strong> - This part allows event handlers to block the operation.</li>

    <li><strong>Pre</strong> - This part allows event handlers to run code before the operation takes place.</li>

    <li><strong>Post</strong> - This part allows event handlers to run code after the operation has finished.</li>
</ol>

<p><strong><br />
When and where do these events fire?<br /></strong> Here is the basic timeline:<br />
<img border="0" alt="" src="eventTimeline.png" /></p>

<p>If restrictions are found during the GetRestrictioins phase, the operation is blocked and never continues to the Pre.&nbsp; If there are no restrictions, things continue to the Pre.&nbsp; Unless something unexpected occurs, Pre, Web Service call and Post should always execute.</p>

<p>As you can see, the events happen around the web service call.&nbsp; In other words, at the layer where the client communicates with the server.&nbsp;</p>

<p>Keep in mind these events may or may not correlate with the UI command that the user invokes. For example, a user performs a Get command on a file in Vault Explorer.&nbsp; This may trigger multiple download events if an entire assembly needs to be download.&nbsp; Or it may trigger no events if the file on disk is up-to-date.</p>

<p><strong><br />
What can I do in an event handler?<br /></strong> Inside a GetRestrictions event you can block the operation and provide the reason for the restriction.&nbsp; Inside a Pre and a Post event you run extra operations, such as sending off an email or queuing up a Job.</p>

<p><strong><br />
What can't I do in an event handler?<br /></strong> You can't change the parameters to or from the operation.&nbsp; You can see most of the parameters passed in, but you can't change them.&nbsp; Likewise you see the return result, but you can't alter it.&nbsp; For example, in the Pre AddFile event you can see that the file name parameter is "Part1.dwg", your code <strong>cannot</strong> change that name to "ZX-0389.dwg".<br />
<br />
You should also avoid UI in an event handler.&nbsp; You don't know what context your handler is running in.&nbsp; For example, you could be running in a command line utility or a service.<br />
<br />
Bubbling up exceptions is not a good idea.&nbsp; Again, you don't know the context you are running in, so an exception might end up shutting down the parent application.&nbsp; The safest thing is to wrap each event handler in a try/catch block.<br />
<br />
Lastly, make sure you don't create and infinite recursion of events.&nbsp; For example, during a Pre AddFile event, your code adds a file, which triggers an AddFile event, which causes your code to add a file, and so on.&nbsp; Even if your code works fine on its own, remember that there might be other event handlers loaded.&nbsp; So your handler might run and operation that triggers another handler, which runs an operation that triggers back to your handler, and so on ad infinitum.&nbsp;</p>

<p><strong><br />
If the Vault server throws an error do I get a Post event?<br /></strong> Yes, and you can see the Exception that is thrown.</p>

<p><strong><br />
Am I guaranteed a Post event?<br /></strong> Not in all cases.&nbsp; It's technically possible for the operation to complete on the server, but your computer loses power right before the Post event.&nbsp; However during normal operation, yes, you will always get a Post event.</p>

<p><strong><br />
Is there anyway to enforce that an Event fires?<br /></strong> No.&nbsp; If the computer doesn't have your handler installed, or your hander fails to load for some reason, the operation will go through without hitting your code.</p>

<p><strong><br />
How do I write an event handler?<br /></strong> A detailed list of steps can be found in the <a href="topic16.html">Getting Started</a> section of the API documentation.&nbsp; The <strong>RestrictOperations</strong> sample in the SDK has sample code.</p>

<p>Here are the basic steps:</p>

<ol>
    <li>Create your DLL project</li>

    <li>Reference Auotdesk.Connectivity.WebServices.dll</li>

    <li>Add a class that implements IWebServiceExtension</li>

    <li>In the OnLoad() implementation, hook to the events that you care about.&nbsp; The hooks are on the web services objects themselves.&nbsp; (ex.&nbsp; DocumentService.AddFileEvents.GetRestrictions )</li>

    <li>Write the event handler code</li>

    <li>Deploy</li>
</ol>

<p><strong><br />
I wrote a Vault client, will event handlers be hooking to my application?<br /></strong> If you use Autodesk.Connectivity.WebServices.dll to communicate with the Vault Server, yes.&nbsp; So your code should handle cases where operations are blocked by other event handlers.&nbsp; In your app, these restrictions will bubble up as an Exception of type Autodesk.Connectivity.Extensibility.Framework.ExtensionException.</p>

<p><strong><br />
Are my handlers specific to a version of Vault?<br /></strong> Yes.&nbsp; For example, your Vault 2012 extension can handle events from the Vault 2012 version of Autodesk.Connectivity.WebServices.dll, but not from any other version of the DLL.</p>

<p><strong><br />
Which Web Service functions fire which events?<br /></strong> You can see the full mapping in the <strong>Web Service Command Event Mappings</strong> of the Knowledge Base in the Vault SDK documentation.&nbsp; There are no cases where a web service function fires multiple events.</p>

<p><strong><br />
Are there other event types?<br /></strong> Yes, but I'll cover those in another post.</p>

<p>&nbsp;</p><!--DXMETADATA end-->
            <a name="seealsobookmark"></a>
            <!--DXMETADATA start type="FilteredItemList" scrap="CATEGORISED_LINKS" namespace="linkcategory" source="Item" filter="" NoHeader="True" NoFooter="True" format="%%replaceinquotes:value=false%%%%scrap:name=_COLLAPSIBLE_HEADER,idprefix=seealso,caption=""%%phrase:name=SeeAlso%%%%designlist:tagidentifier=seealso,itemtype=See Also%%""%%%%filtereditemlist%%</div>"--><!--DXMETADATA end-->
        </div>
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_FOOTER" --><!--DXMETADATA end -->
        <div id="pagefooter">
            <!--DXMETADATA start type="Variable" name="CopyrightNotice" format="<p>&nbsp;</p><p>&nbsp;</p><hr style=""height: 1px"" /><p>%%variable%%</p>" --><!--DXMETADATA end -->
        </div>
        <!--DXMETADATA start type="FeedbackSection" --><!--DXMETADATA end -->
    </div>
    <!--DXMETADATA start type="Variable" name="NonScrollingPageFooter" format="<div id=nonscrollingpagefooter>%%variable%%</div>" --><div id=nonscrollingpagefooter>&copy;2025. All Rights Reserved.</div><!--DXMETADATA end -->
</body>
</html>