<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:innovasys xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
    <!--DXMETADATA start type="MetaCharset" --><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"><!--DXMETADATA end-->
    <meta content="history" name="save" />
    <meta name="GENERATOR" content="Innovasys HelpStudio (http://www.innovasys.com)" />
    <!--DXMETADATA start type="ItemTitle" format="<title>%%ItemTitle%%</title>" --><title>How To Acquire Files</title><!--DXMETADATA end-->
    <link rel="stylesheet" type="text/css" href="stylesheets/helpstudio.css" />
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/community.css"">" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="Literal" condition="helpversion:value=2" value="<link rel=""stylesheet"" type=""text/css"" href=""stylesheets/help2.css"">" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Stylesheets" --><link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-simpletab.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-heading-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-tabstrip.css"></link><!--DXMETADATA end-->
    <script src="script/helpstudio.js" type="text/javascript"></script>
    <!--DXMETADATA start type="Literal" condition="communityenabled" value="<script src=""script/community.js""></script>" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Scripts" --><script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-common.js" type="text/javascript"></script>
    <script src="script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-tabstrip.js" type="text/javascript"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="Variable" name="BannerColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {background-color: %%Variable%%}</style>" blankformat="" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="Variable" name="BannerTextColor" format="<style type=text/css>div#pagetop, div#pagetop table td, span#projecttitle, span#pagetitle {color: %%Variable:Name=BannerTextColor%%}</style>" blankformat="" --><!--DXMETADATA end -->
	<!--DXMETADATA start type="Variable" name="TopicXMLIsland" condition="helpversion:value=2" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="DesignTime" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CanonicalLink" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CustomHeadContent" --><!--DXMETADATA end-->
</head>
<body id="hsbody">
	<!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_PROPERTIES" --><!--DXMETADATA end -->
    <div style="display: none">
        <input type="hidden" id="userDataCache" class="userDataStyle" name="userDataCache" />
        <input type="hidden" id="hiddenScrollOffset" name="hiddenScrollOffset" />
    </div>
    <img id="collapseImage" style="display:none; height:0; width:0;" src="images/collapse.gif">
    <img id="expandImage" style="display:none; height:0; width:0;" src="images/expand.gif"/>
    <img id="copyImage" style="display:none; height:0; width:0;" src="images/copycode.gif"/>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="images/copycodeHighlight.gif">
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="images/drpdown.gif"/>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="images/drpdown_orange.gif"/>
    <div id="pagetop">
        <!--DXMETADATA start type="DesignBanner" --><!--DXMETADATA end -->
        <table width="100%" id="pagetoptable2" cellspacing="0" cellpadding="0">
        	<tr>
        		<td><!--DXMETADATA start type="Literal" condition="communityenabled" value="%%scrap:name=_COMMUNITY_RATING%%%%scrap:name=_COMMUNITY_DROPDOWN%%" --><!--DXMETADATA end --></td>
        	</tr>
        </table>
        <table width="100%" id="pagetoptable1">
            <tr id="pagetoptable1row1">
                <td align="left">
                    <span id="projecttitle">
                        <!--DXMETADATA start type="ProjectTitle" -->Vault SDK<!--DXMETADATA end-->
                    </span>
                </td>
                <td align="right" rowspan="2">
                    <!--DXMETADATA start type="LogoImage" --><!--DXMETADATA end-->
                </td>
            </tr>
            <tr id="pagetoptable1row2">
                <td align="left">
                    <span id="pagetitle">
                        <!--DXMETADATA start type="ItemTitle" -->How To Acquire Files<!--DXMETADATA end-->
                    </span>
                </td>
            </tr>
            <tr id="pagetoptable1row3">
            	<td colspan="2">
            		<!--DXMETADATA start type="Literal" condition="childitems:itemtype=linkcategory" value="<a href=""#seealsobookmark"">%%Phrase:Name=SeeAlso,BlankFormat=See Also%%</a>" --><!--DXMETADATA end -->
            		<span id="feedbacklink"><!--DXMETADATA start type="Variable" name="FeedbackLink" format="" --><a href="http://forums.autodesk.com/t5/vault-customization/bd-p/301 " rel="noopener noreferrer" target="_blank">Send Feedback</a><!--DXMETADATA end --></span>
            	</td>
            </tr>
        </table>
        <!--DXMETADATA start type="Breadcrumbs" scrap="_BREADCRUMBS" --><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
<a href="topic46.html">Knowledge Base</a>
 > How To Acquire Files</td></tr></table><!--DXMETADATA end -->
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_MENU" --><!--DXMETADATA end -->
    </div>
    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>
    <div id="pagebody">
        <div id="mainbody">
<!--DXMETADATA start type="TopicSection" name="BodyText"--><p>by Doug Redmond, It's All Just Ones and Zeros<br />
05/14/2013</p>

<p>DocumentService.DownloadFile and DocumentService.CheckoutFile were removed in the 2014 API.&nbsp; So that kind of forces the issue.&nbsp; Connection.FileManager.AcquireFiles is the replacement.&nbsp; I’ll go over the architectural reason for the change in a later article.</p>
<hr />

<p><strong>Benefits of AcquireFiles</strong></p>

<p>Yes, it’s a pain to have to update your code, but let me go over the benefits before you get too distraught.&nbsp;</p>

<ul>
    <li>Downloads files to the working folder by default.</li>

    <li>Automatically handles large files.</li>

    <li>Automatically repairs broken references for known CAD file types.</li>

    <li>Can download entire assemblies in one call.</li>

    <li>Multi-thread download.&nbsp; It’s about 2x quicker when downloading an assembly.</li>

    <li>Get/checkout dialog available.</li>

    <li>Automatically sets file attributes, such as read-only and create date.</li>
</ul>

<p>The only disadvantage that I have come across is that you can’t read a file directly into memory.&nbsp; You always acquire to a location on disk.&nbsp; The workaround is to acquire to a temp location, read the file to memory, then delete the temp file.</p>
<hr />

<p>Here is some sample code.</p>

<div id="Syntax_CS" class="LanguageSpecific" data-title="CS" data-itemid="CS">
    <table class="syntaxtable" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th class="codeboxtitlecell">CS</th>

                <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
            </tr>

            <tr>
                <td colspan="2">
                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">using</span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>VDF = Autodesk.DataManagement.Client.Framework;</span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">public</span></span></span><span><span style="FONT-SIZE: 9pt"><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">void</span></span><span style="COLOR: rgb(0,0,0)">DownlodFiles(</span><span><span style="COLOR: rgb(43,145,175)">ICollection</span></span><span style="COLOR: rgb(0,0,0)">&lt;VDF.Vault.Currency.Entities.</span><span><span style="COLOR: rgb(43,145,175)">FileIteration</span></span><span style="COLOR: rgb(0,0,0)">&gt; fileIters)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,0)">{</span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,128,0)">// download individual files to a temp location</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Settings.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">AcquireFilesSettings</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>settings =</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">new</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>VDF.Vault.Settings.</span><span><span style="COLOR: rgb(43,145,175)">AcquireFilesSettings</span></span><span style="COLOR: rgb(0,0,0)">(m_conn);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">settings.LocalPath =<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">new</span></span><span style="COLOR: rgb(0,0,0)">VDF.Currency.</span><span><span style="COLOR: rgb(43,145,175)">FolderPathAbsolute</span></span><span style="COLOR: rgb(0,0,0)">(</span><span><span style="COLOR: rgb(163,21,21)">@"c:\temp"</span></span><span style="COLOR: rgb(0,0,0)">);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">foreach</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>(VDF.Vault.Currency.Entities.</span><span><span style="COLOR: rgb(43,145,175)">FileIteration</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>fileIter<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">in</span></span><span style="COLOR: rgb(0,0,0)">fileIters)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">{</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">settings.AddFileToAcquire(fileIter,</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Settings.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">AcquireFilesSettings</span></span><span style="COLOR: rgb(0,0,0)">.</span><span><span style="COLOR: rgb(43,145,175)">AcquisitionOption</span></span><span style="COLOR: rgb(0,0,0)">.Download);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">}</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Results.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">AcquireFilesResults</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>results = m_conn.FileManager.AcquireFiles(settings);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,0)">}</span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">public</span></span></span><span><span style="FONT-SIZE: 9pt"><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">void</span></span><span style="COLOR: rgb(0,0,0)">DownloadAssembly(VDF.Vault.Currency.Entities.</span><span><span style="COLOR: rgb(43,145,175)">FileIteration</span></span><span style="COLOR: rgb(0,0,0)">topLevelAssembly)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,0)">{</span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,128,0)">// download the latest version of the assembly to working folders</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Settings.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">AcquireFilesSettings</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>settings =</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">new</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>VDF.Vault.Settings.</span><span><span style="COLOR: rgb(43,145,175)">AcquireFilesSettings</span></span><span style="COLOR: rgb(0,0,0)">(m_conn);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: xx-small"><span style="COLOR: rgb(0,0,0)"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>settings.OptionsRelationshipGathering.FileRelationshipSettings.IncludeChildren =<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">true</span></span><span style="COLOR: rgb(0,0,0)">;</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: xx-small"><span style="COLOR: rgb(0,0,0)"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>settings.OptionsRelationshipGathering.FileRelationshipSettings.RecurseChildren =<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">true</span></span><span style="COLOR: rgb(0,0,0)">;</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: xx-small"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>settings.OptionsRelationshipGathering.FileRelationshipSettings.VersionGatheringOption =</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Currency.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">VersionGatheringOption</span></span><span style="COLOR: rgb(0,0,0)">.Latest;</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">settings.AddFileToAcquire(topLevelAssembly,</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Settings.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">AcquireFilesSettings</span></span><span style="COLOR: rgb(0,0,0)">.</span><span><span style="COLOR: rgb(43,145,175)">AcquisitionOption</span></span><span style="COLOR: rgb(0,0,0)">.Download);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Results.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">AcquireFilesResults</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>results =</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">m_conn.FileManager.AcquireFiles(settings);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,0)">}</span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">public</span></span></span><span><span style="FONT-SIZE: 9pt"><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">void</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>DownloadDialog(VDF.Vault.Currency.Entities.</span><span><span style="COLOR: rgb(43,145,175)">FileIteration</span></span><span style="COLOR: rgb(0,0,0)">fileIter,</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">IntPtr</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>parentWindowHandle)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,0)">{</span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,128,0)">// pop up the Get/Checkout dialog</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Forms.Settings.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">InteractiveAcquireFileSettings</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>settings =</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">new</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>VDF.Vault.Forms.Settings.</span><span><span style="COLOR: rgb(43,145,175)">InteractiveAcquireFileSettings</span></span><span style="COLOR: rgb(0,0,0)">(</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">m_conn, parentWindowHandle,<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(163,21,21)">"Download files"</span></span><span style="COLOR: rgb(0,0,0)">);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">settings.AddEntityToAcquire(fileIter);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Forms.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">Library</span></span><span style="COLOR: rgb(0,0,0)">.AcquireFiles(settings);</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,0)">}</span></span></span></p>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div id="Syntax_VB.NET" class="LanguageSpecific" data-title="VB.NET" data-itemid="VB.NET">
    <table class="syntaxtable" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th class="codeboxtitlecell">VB.NET</th>

                <th class="codeboxactioncell"><span class="hs-onlineonly"><span onclick="copyCode(this)" tabindex="0" onkeypress="CopyCode_CheckKey(this)" onmouseover="changeCopyCodeIcon(this,true)" onfocusin="changeCopyCodeIcon(this,true)" onmouseout="changeCopyCodeIcon(this,false)" onfocusout="changeCopyCodeIcon(this,false)" class="copyCode"><img class="copyCodeImage" name="ccImage" src="images/copycode.gif" align="absmiddle" />Copy Code</span></span></th>
            </tr>

            <tr>
                <td colspan="2">
                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,0)"><span style="COLOR: rgb(0,0,255)">Imports</span><span class="Apple-converted-space">&nbsp;</span>VDF = Autodesk.DataManagement.Client.Framework</span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">Public</span></span></span><span><span style="FONT-SIZE: 9pt"><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">Sub</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>DownlodFiles(fileIters<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(43,145,175)">ICollection</span></span><span style="COLOR: rgb(0,0,0)">(</span><span><span style="COLOR: rgb(0,0,255)">Of</span></span><span style="COLOR: rgb(0,0,0)">VDF.Vault.Currency.Entities.</span><span><span style="COLOR: rgb(43,145,175)">FileIteration</span></span><span style="COLOR: rgb(0,0,0)">))</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,128,0)">' download individual files to a temp location</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">Dim</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>settings<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">New</span></span><span style="COLOR: rgb(0,0,0)">VDF.Vault.Settings.</span><span><span style="COLOR: rgb(43,145,175)">AcquireFilesSettings</span></span><span style="COLOR: rgb(0,0,0)">(m_conn)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">settings.LocalPath =<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">New</span></span><span style="COLOR: rgb(0,0,0)">VDF.Currency.</span><span><span style="COLOR: rgb(43,145,175)">FolderPathAbsolute</span></span><span style="COLOR: rgb(0,0,0)">(</span><span><span style="COLOR: rgb(163,21,21)">"c:\temp"</span></span><span style="COLOR: rgb(0,0,0)">)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">For</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">Each</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>fileIter<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)">VDF.Vault.Currency.Entities.</span><span><span style="COLOR: rgb(43,145,175)">FileIteration</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">In</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>fileIters</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">settings.AddFileToAcquire(fileIter, _ _</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>VDF.Vault.Settings.AcquireFilesSettings.AcquisitionOption.Download)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,255)">Next</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">Dim</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>results<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>VDF.Vault.Results.</span><span><span style="COLOR: rgb(43,145,175)">AcquireFilesResults</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>= _</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>m_conn.FileManager.AcquireFiles(settings)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">End</span></span></span><span><span style="FONT-SIZE: 9pt"><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,255)">Sub</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">Public</span></span></span><span><span style="FONT-SIZE: 9pt"><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">Sub</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>DownloadAssembly(topLevelAssembly<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)">VDF.Vault.Currency.Entities.</span><span><span style="COLOR: rgb(43,145,175)">FileIteration</span></span><span style="COLOR: rgb(0,0,0)">)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,128,0)">' download the latest version of the assembly to working folders</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">Dim</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>settings<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">New</span></span><span style="COLOR: rgb(0,0,0)">VDF.Vault.Settings.</span><span><span style="COLOR: rgb(43,145,175)">AcquireFilesSettings</span></span><span style="COLOR: rgb(0,0,0)">(m_conn)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: xx-small"><span style="COLOR: rgb(0,0,0)"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>settings.OptionsRelationshipGathering.FileRelationshipSettings.IncludeChildren =<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">True</span></span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="FONT-SIZE: xx-small"><span style="COLOR: rgb(0,0,0)"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>settings.OptionsRelationshipGathering.FileRelationshipSettings.RecurseChildren =<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">True</span></span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: xx-small"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>settings.OptionsRelationshipGathering.FileRelationshipSettings.VersionGatheringOption = _</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>VDF.Vault.Currency.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">VersionGatheringOption</span></span><span style="COLOR: rgb(0,0,0)">.Latest</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">settings.AddFileToAcquire(topLevelAssembly, _</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span>&nbsp;&nbsp;&nbsp;</span>VDF.Vault.Settings.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">AcquireFilesSettings</span></span><span style="COLOR: rgb(0,0,0)">.</span><span><span style="COLOR: rgb(43,145,175)">AcquisitionOption</span></span><span style="COLOR: rgb(0,0,0)">.Download)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">Dim</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>results<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>VDF.Vault.Results.</span><span><span style="COLOR: rgb(43,145,175)">AcquireFilesResults</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>= _</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>m_conn.FileManager.AcquireFiles(settings)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">End</span></span></span><span><span style="FONT-SIZE: 9pt"><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,255)">Sub</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">Public</span></span></span><span><span style="FONT-SIZE: 9pt"><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">Sub</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>DownloadDialog(fileIter<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)">VDF.Vault.Currency.Entities.</span><span><span style="COLOR: rgb(43,145,175)">FileIteration</span></span><span style="COLOR: rgb(0,0,0)">, _</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">parentWindowHandle<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(43,145,175)">IntPtr</span></span><span style="COLOR: rgb(0,0,0)">)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,128,0)">' pop up the Get/Checkout dialog</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,0)"><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(0,0,255)">Dim</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span>settings<span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">As</span></span><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span><span><span style="COLOR: rgb(0,0,255)">New</span></span><span style="COLOR: rgb(0,0,0)">VDF.Vault.Forms.Settings.</span><span><span style="COLOR: rgb(43,145,175)">InteractiveAcquireFileSettings</span></span><span style="COLOR: rgb(0,0,0)">( _</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span>m_conn, parentWindowHandle,<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(163,21,21)">"Download files"</span></span><span style="COLOR: rgb(0,0,0)">)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">settings.AddEntityToAcquire(fileIter)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal">&nbsp;</p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span><span style="FONT-FAMILY: Consolas"><span style="COLOR: rgb(0,0,0)"><span><span style="FONT-SIZE: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span></span><span style="FONT-SIZE: 9pt">VDF.Vault.Forms.</span></span><span style="FONT-SIZE: 9pt"><span><span style="COLOR: rgb(43,145,175)">Library</span></span><span style="COLOR: rgb(0,0,0)">.AcquireFiles(settings)</span></span></span></span></p>

                    <p class="MsoNormal" style="TEXT-ALIGN: left; MARGIN: 0in 0in 0pt; LINE-HEIGHT: normal"><span style="FONT-FAMILY: Consolas"><span><span style="COLOR: rgb(0,0,255)"><span style="FONT-SIZE: 9pt">End</span></span></span><span><span style="FONT-SIZE: 9pt"><span style="COLOR: rgb(0,0,0)"><span class="Apple-converted-space">&nbsp;</span></span></span><span><span style="FONT-SIZE: 9pt; COLOR: rgb(0,0,255)">Sub</span></span></span></span></p>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<h3 class="entry-header">File Transfer - Doing it the Hard Way</h3>

<p>So, you don’t want to use AcquireFiles?&nbsp; You want to stick with web services?&nbsp; Fine, you can do that, but don’t say I didn’t warn you.&nbsp; The web service mechanism for uploading/downloading got real ugly in Vault 2014.</p>

<p>The main reason for the change was the <a href="topic59.html" target="_blank">file store server architecture</a>.&nbsp; The database server controls things like security and the file store server controls the actual bits.&nbsp; So you need to make at least 2 calls for every file transfer.&nbsp; Also, there are special headers that need to get set on each call.&nbsp; They were optional in the last release but they are required for 2014.</p>

<p>It’s probably best if I just post the code...<br />
<a href="http://justonesandzeros.typepad.com/Files/LegacyFileTransfer/LegacyFileTransfer.cs">LegacyFileTransfer.cs</a>&nbsp;<br />
<a href="http://justonesandzeros.typepad.com/Files/LegacyFileTransfer/LegacyFileTransfer.vb">LegacyFileTransfer.vb</a></p>

<p>The code above contains examples of AddFile, CheckinFile, CheckoutFile, and DownloadFile.&nbsp; All Vault operations are done through the WebServiceManager.&nbsp; No Connection object required.</p><!--DXMETADATA end-->
            <a name="seealsobookmark"></a>
            <!--DXMETADATA start type="FilteredItemList" scrap="CATEGORISED_LINKS" namespace="linkcategory" source="Item" filter="" NoHeader="True" NoFooter="True" format="%%replaceinquotes:value=false%%%%scrap:name=_COLLAPSIBLE_HEADER,idprefix=seealso,caption=""%%phrase:name=SeeAlso%%%%designlist:tagidentifier=seealso,itemtype=See Also%%""%%%%filtereditemlist%%</div>"--><!--DXMETADATA end-->
        </div>
        <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_FOOTER" --><!--DXMETADATA end -->
        <div id="pagefooter">
            <!--DXMETADATA start type="Variable" name="CopyrightNotice" format="<p>&nbsp;</p><p>&nbsp;</p><hr style=""height: 1px"" /><p>%%variable%%</p>" --><!--DXMETADATA end -->
        </div>
        <!--DXMETADATA start type="FeedbackSection" --><!--DXMETADATA end -->
    </div>
    <!--DXMETADATA start type="Variable" name="NonScrollingPageFooter" format="<div id=nonscrollingpagefooter>%%variable%%</div>" --><div id=nonscrollingpagefooter>&copy;2025. All Rights Reserved.</div><!--DXMETADATA end -->
</body>
</html>