<Window x:Class="XnrgyEngineeringAutomationTools.Views.UploadTemplateWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Upload Template vers Vault - v1.0.0 - By Mohammed Amine Elgalai - XNRGY CLIMATE SYSTEMS ULC" 
        Height="800" Width="1200"
        MinHeight="600" MinWidth="900"
        WindowStartupLocation="CenterOwner"
        WindowState="Maximized"
        Loaded="Window_Loaded"
        Closing="Window_Closing">

    <Window.Resources>
        <!-- ========== COULEURS THEME SOMBRE ========== -->
        <SolidColorBrush x:Key="XnrgyBlue" Color="#0078D4"/>
        <SolidColorBrush x:Key="XnrgyGreen" Color="#107C10"/>
        <SolidColorBrush x:Key="XnrgyOrange" Color="#FF8C00"/>
        <SolidColorBrush x:Key="XnrgyRed" Color="#E81123"/>
        
        <!-- Theme Sombre (defaut) -->
        <SolidColorBrush x:Key="DarkBg" Color="#1E1E2E"/>
        <SolidColorBrush x:Key="DarkBg2" Color="#252536"/>
        <SolidColorBrush x:Key="DarkBg3" Color="#2D2D44"/>
        <SolidColorBrush x:Key="BorderColor" Color="#404060"/>
        <SolidColorBrush x:Key="TextLight" Color="#E0E0E0"/>
        <SolidColorBrush x:Key="TextMuted" Color="#888888"/>
        <SolidColorBrush x:Key="TextDark" Color="#1A1A28"/>

        <!-- ========== STYLE TEXTBOX ========== -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="{DynamicResource DarkBg3}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextLight}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="2"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="{StaticResource XnrgyBlue}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ========== STYLE LABEL ========== -->
        <Style x:Key="ModernLabel" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource TextLight}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>

        <!-- ========== STYLE BOUTON PRINCIPAL ========== -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource XnrgyBlue}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="25,12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6" 
                                BorderBrush="{DynamicResource BorderColor}" BorderThickness="2" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#1E8FE8"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#404060"/>
                                <Setter Property="Foreground" Value="#666"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ========== STYLE BOUTON SECONDAIRE ========== -->
        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource DarkBg3}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextLight}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6" 
                                BorderBrush="{DynamicResource BorderColor}" BorderThickness="2" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3D3D56"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ========== STYLE BOUTON SUCCES ========== -->
        <Style x:Key="SuccessButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource XnrgyGreen}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="30,15"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="8" 
                                BorderBrush="{DynamicResource BorderColor}" BorderThickness="2" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#0F6A0F"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#404060"/>
                                <Setter Property="Foreground" Value="#666"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ========== STYLE BOUTON DANGER ========== -->
        <Style x:Key="DangerButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource XnrgyRed}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6" 
                                BorderBrush="{DynamicResource BorderColor}" BorderThickness="2" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#C41020"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#404060"/>
                                <Setter Property="Foreground" Value="#666"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ========== STYLE GROUPBOX ========== -->
        <Style x:Key="ModernGroupBox" TargetType="GroupBox">
            <Setter Property="Background" Value="{DynamicResource DarkBg2}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GroupBox">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="{DynamicResource TextDark}" CornerRadius="8,8,0,0" 
                                    BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2,2,2,0" Padding="15,10">
                                <ContentPresenter ContentSource="Header"/>
                            </Border>
                            <Border Grid.Row="1" Background="{TemplateBinding Background}" 
                                    CornerRadius="0,0,8,8" BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="2,0,2,2" Padding="{TemplateBinding Padding}">
                                <ContentPresenter/>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ========== STYLE PROGRESSBAR MODERNE ========== -->
        <Style x:Key="ModernProgressBar" TargetType="ProgressBar">
            <Setter Property="Height" Value="25"/>
            <Setter Property="Background" Value="{DynamicResource DarkBg3}"/>
            <Setter Property="Foreground" Value="{StaticResource XnrgyBlue}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Grid>
                            <Border x:Name="PART_Track" Background="{TemplateBinding Background}" CornerRadius="12"/>
                            <Border x:Name="PART_Indicator" Background="{TemplateBinding Foreground}" 
                                    CornerRadius="12" HorizontalAlignment="Left">
                                <Border.Effect>
                                    <DropShadowEffect Color="#0078D4" BlurRadius="10" ShadowDepth="0" Opacity="0.5"/>
                                </Border.Effect>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ========== STYLE CHECKBOX ========== -->
        <Style x:Key="ModernCheckBox" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{DynamicResource TextLight}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <StackPanel Orientation="Horizontal">
                            <Border x:Name="checkBorder" Width="20" Height="20" Background="{DynamicResource DarkBg3}" 
                                    BorderBrush="{DynamicResource BorderColor}" BorderThickness="2" CornerRadius="4" 
                                    VerticalAlignment="Center" Margin="0,0,8,0">
                                <Path x:Name="checkMark" Data="M 2,6 L 6,10 L 12,2" Stroke="White" StrokeThickness="2" 
                                      Visibility="Collapsed" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </Border>
                            <ContentPresenter VerticalAlignment="Center"/>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="checkBorder" Property="Background" Value="{StaticResource XnrgyBlue}"/>
                                <Setter TargetName="checkBorder" Property="BorderBrush" Value="{StaticResource XnrgyBlue}"/>
                                <Setter TargetName="checkMark" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="checkBorder" Property="BorderBrush" Value="{StaticResource XnrgyBlue}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- ========== CONTENU PRINCIPAL ========== -->
    <Grid x:Name="MainGrid" Background="{DynamicResource DarkBg}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="200"/>
        </Grid.RowDefinitions>

        <!-- ========== EN-TETE ========== -->
        <Border Grid.Row="0" Background="{DynamicResource TextDark}" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Logo et titre -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Image x:Name="LogoImage" Width="45" Height="45" Margin="0,0,15,0"/>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Upload Template vers Vault" FontSize="22" FontWeight="Bold" 
                                   Foreground="{StaticResource XnrgyBlue}"/>
                        <TextBlock Text="Upload massif de fichiers vers Vault Production" 
                                   FontSize="12" Foreground="{DynamicResource TextMuted}"/>
                    </StackPanel>
                </StackPanel>

                <!-- Statut connexion -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Ellipse x:Name="StatusIndicator" Width="12" Height="12" Fill="#666" Margin="0,0,8,0"/>
                    <TextBlock x:Name="StatusText" Text="Non connecte" FontSize="13" 
                               Foreground="{DynamicResource TextMuted}" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ========== CONTENU CENTRAL ========== -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- ===== COLONNE GAUCHE - CONFIGURATION ===== -->
                <StackPanel Grid.Column="0">

                    <!-- Dossier Source -->
                    <GroupBox Style="{StaticResource ModernGroupBox}">
                        <GroupBox.Header>
                            <TextBlock Text="[i] Dossier Source (Local)" FontSize="14" FontWeight="Bold" 
                                       Foreground="{StaticResource XnrgyBlue}"/>
                        </GroupBox.Header>
                        <StackPanel>
                            <TextBlock Text="Chemin local a uploader" Style="{StaticResource ModernLabel}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="TxtLocalPath" Style="{StaticResource ModernTextBox}" 
                                         Text="C:\Vault" Grid.Column="0"/>
                                <Button x:Name="BtnBrowse" Content="..." Style="{StaticResource SecondaryButton}" 
                                        Grid.Column="1" Margin="10,0,0,0" Padding="15,8" Click="BtnBrowse_Click"/>
                            </Grid>
                            <TextBlock x:Name="TxtVaultPath" Text="Destination Vault: $/" Margin="0,10,0,0"
                                       FontSize="12" Foreground="{DynamicResource TextMuted}"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Options -->
                    <GroupBox Style="{StaticResource ModernGroupBox}">
                        <GroupBox.Header>
                            <TextBlock Text="[i] Options d'Upload" FontSize="14" FontWeight="Bold" 
                                       Foreground="{StaticResource XnrgyBlue}"/>
                        </GroupBox.Header>
                        <StackPanel>
                            <CheckBox x:Name="ChkSkipExisting" Content="Ignorer les fichiers existants dans Vault" 
                                      Style="{StaticResource ModernCheckBox}" IsChecked="True" Margin="0,5"/>
                            <CheckBox x:Name="ChkCreateFolders" Content="Creer les dossiers automatiquement" 
                                      Style="{StaticResource ModernCheckBox}" IsChecked="True" Margin="0,5"/>
                            <CheckBox x:Name="ChkExcludeOldVersions" Content="Exclure dossiers OldVersions/Backup" 
                                      Style="{StaticResource ModernCheckBox}" IsChecked="True" Margin="0,5"/>
                            <CheckBox x:Name="ChkExcludeTempFiles" Content="Exclure fichiers temporaires (.bak, .tmp, .lck)" 
                                      Style="{StaticResource ModernCheckBox}" IsChecked="True" Margin="0,5"/>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>

                <!-- ===== COLONNE DROITE - STATISTIQUES ET ACTIONS ===== -->
                <StackPanel Grid.Column="2">
                    
                    <!-- Statistiques Scan -->
                    <GroupBox Style="{StaticResource ModernGroupBox}">
                        <GroupBox.Header>
                            <TextBlock Text="[#] Statistiques" FontSize="14" FontWeight="Bold" 
                                       Foreground="{StaticResource XnrgyBlue}"/>
                        </GroupBox.Header>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Column="0" Grid.Row="0" Background="{DynamicResource DarkBg3}" 
                                    CornerRadius="6" Padding="15,10" Margin="0,0,5,10">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="Total Fichiers" FontSize="11" Foreground="{DynamicResource TextMuted}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="TxtTotalFiles" Text="0" FontSize="28" FontWeight="Bold" 
                                               Foreground="{StaticResource XnrgyBlue}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <Border Grid.Column="1" Grid.Row="0" Background="{DynamicResource DarkBg3}" 
                                    CornerRadius="6" Padding="15,10" Margin="5,0,0,10">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="Total Dossiers" FontSize="11" Foreground="{DynamicResource TextMuted}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="TxtTotalFolders" Text="0" FontSize="28" FontWeight="Bold" 
                                               Foreground="{StaticResource XnrgyOrange}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <Border Grid.Column="0" Grid.Row="1" Background="{DynamicResource DarkBg3}" 
                                    CornerRadius="6" Padding="15,10" Margin="0,0,5,10">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="Uploades" FontSize="11" Foreground="{DynamicResource TextMuted}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="TxtUploaded" Text="0" FontSize="28" FontWeight="Bold" 
                                               Foreground="{StaticResource XnrgyGreen}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <Border Grid.Column="1" Grid.Row="1" Background="{DynamicResource DarkBg3}" 
                                    CornerRadius="6" Padding="15,10" Margin="5,0,0,10">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="Ignores" FontSize="11" Foreground="{DynamicResource TextMuted}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="TxtSkipped" Text="0" FontSize="28" FontWeight="Bold" 
                                               Foreground="{DynamicResource TextMuted}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <Border Grid.Column="0" Grid.Row="2" Background="{DynamicResource DarkBg3}" 
                                    CornerRadius="6" Padding="15,10" Margin="0,0,5,10">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="Echecs" FontSize="11" Foreground="{DynamicResource TextMuted}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="TxtFailed" Text="0" FontSize="28" FontWeight="Bold" 
                                               Foreground="{StaticResource XnrgyRed}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <Border Grid.Column="1" Grid.Row="2" Background="{DynamicResource DarkBg3}" 
                                    CornerRadius="6" Padding="15,10" Margin="5,0,0,10">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="Dossiers Crees" FontSize="11" Foreground="{DynamicResource TextMuted}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="TxtFoldersCreated" Text="0" FontSize="28" FontWeight="Bold" 
                                               Foreground="{StaticResource XnrgyBlue}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <!-- Bouton Scanner -->
                            <Button x:Name="BtnScan" Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="3"
                                    Content="[?] Scanner les fichiers" Style="{StaticResource SecondaryButton}" 
                                    Click="BtnScan_Click" Margin="0,5,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Apercu Extensions -->
                    <GroupBox Style="{StaticResource ModernGroupBox}">
                        <GroupBox.Header>
                            <TextBlock Text="[i] Apercu par Extension" FontSize="14" FontWeight="Bold" 
                                       Foreground="{StaticResource XnrgyBlue}"/>
                        </GroupBox.Header>
                        <ListBox x:Name="LstExtensions" Background="Transparent" BorderThickness="0" 
                                 MaxHeight="150" Foreground="{DynamicResource TextLight}">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="5,3">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="60"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Extension}" Grid.Column="0" FontWeight="SemiBold" 
                                                   Foreground="{StaticResource XnrgyBlue}"/>
                                        <ProgressBar Grid.Column="1" Value="{Binding Percentage}" Maximum="100" 
                                                     Height="8" Background="#404060" Foreground="{StaticResource XnrgyBlue}" 
                                                     Margin="10,0"/>
                                        <TextBlock Text="{Binding Count}" Grid.Column="2" HorizontalAlignment="Right" 
                                                   Foreground="{DynamicResource TextMuted}"/>
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </GroupBox>

                    <!-- Actions -->
                    <GroupBox Style="{StaticResource ModernGroupBox}">
                        <GroupBox.Header>
                            <TextBlock Text="[>] Actions" FontSize="14" FontWeight="Bold" 
                                       Foreground="{StaticResource XnrgyBlue}"/>
                        </GroupBox.Header>
                        <StackPanel>
                            <Button x:Name="BtnStartUpload" Content="[+] DEMARRER L'UPLOAD" 
                                    Style="{StaticResource SuccessButton}" Click="BtnStartUpload_Click" 
                                    IsEnabled="False" Margin="0,0,0,10"/>
                            <Button x:Name="BtnCancel" Content="[-] Annuler" 
                                    Style="{StaticResource DangerButton}" Click="BtnCancel_Click" 
                                    IsEnabled="False"/>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </Grid>
        </ScrollViewer>

        <!-- ========== BARRE DE PROGRESSION ========== -->
        <Border Grid.Row="2" Background="{DynamicResource TextDark}" Padding="20,15">
            <StackPanel>
                <Grid Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock x:Name="TxtProgressStatus" Text="En attente..." FontSize="13" 
                               Foreground="{DynamicResource TextLight}" Grid.Column="0"/>
                    <TextBlock x:Name="TxtProgressPercent" Text="0%" FontSize="13" FontWeight="Bold" 
                               Foreground="{StaticResource XnrgyBlue}" Grid.Column="1"/>
                </Grid>
                <ProgressBar x:Name="ProgressBar" Style="{StaticResource ModernProgressBar}" 
                             Value="0" Maximum="100"/>
                <Grid Margin="0,8,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock x:Name="TxtCurrentFile" Text="" FontSize="11" 
                               Foreground="{DynamicResource TextMuted}" Grid.Column="0" TextTrimming="CharacterEllipsis"/>
                    <TextBlock x:Name="TxtSpeed" Text="" FontSize="11" 
                               Foreground="{DynamicResource TextMuted}" Grid.Column="1" HorizontalAlignment="Center"/>
                    <TextBlock x:Name="TxtTimeRemaining" Text="" FontSize="11" 
                               Foreground="{DynamicResource TextMuted}" Grid.Column="2" HorizontalAlignment="Right"/>
                </Grid>
            </StackPanel>
        </Border>

        <!-- ========== JOURNAL ========== -->
        <Border Grid.Row="3" Background="{DynamicResource DarkBg2}" BorderBrush="{DynamicResource BorderColor}" 
                BorderThickness="0,2,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header Journal -->
                <Border Grid.Row="0" Background="{DynamicResource TextDark}" Padding="15,8">
                    <Grid>
                        <TextBlock Text="[#] Journal des operations" FontSize="12" FontWeight="SemiBold" 
                                   Foreground="{StaticResource XnrgyBlue}"/>
                        <Button x:Name="BtnClearLog" Content="Effacer" Style="{StaticResource SecondaryButton}" 
                                HorizontalAlignment="Right" Padding="10,4" FontSize="11" Click="BtnClearLog_Click"/>
                    </Grid>
                </Border>
                
                <!-- Contenu Journal -->
                <ScrollViewer Grid.Row="1" x:Name="LogScrollViewer" VerticalScrollBarVisibility="Auto">
                    <TextBox x:Name="TxtLog" Background="Transparent" Foreground="{DynamicResource TextLight}" 
                             BorderThickness="0" IsReadOnly="True" TextWrapping="Wrap" 
                             FontFamily="Consolas" FontSize="11" Padding="15,10"
                             VerticalScrollBarVisibility="Disabled"/>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid>
</Window>
