<Window x:Class="XnrgyInstaller.InstallerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="XNRGY Engineering Automation Tools - Installation"
        Height="680" Width="950"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Icon="/Resources/XnrgyEngineeringAutomationTools.ico"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">

    <Border Background="#1E1E2E" CornerRadius="12" BorderBrush="#4A7FBF" BorderThickness="2">
        <Border.Effect>
            <DropShadowEffect Color="#000000" BlurRadius="30" ShadowDepth="0" Opacity="0.5"/>
        </Border.Effect>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER avec Logo et Titre â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Grid.Row="0" Background="#2A4A6F" CornerRadius="10,10,0,0" Padding="20,15">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <!-- Logo XNRGY PNG -->
                        <Image Source="/Resources/XnrgyEngineeringAutomationTools.png" 
                               Width="60" Height="60" Margin="0,0,15,0" 
                               RenderOptions.BitmapScalingMode="HighQuality"/>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="XNRGY Engineering Automation Tools" 
                                       FontSize="20" FontWeight="Bold" Foreground="White"/>
                            <TextBlock x:Name="VersionText" Text="Version 1.0.0 - Installation" 
                                       FontSize="12" Foreground="#B0B0B0" Margin="0,4,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Boutons Fenetre -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Top">
                        <Button Content="â”€" Width="35" Height="30" Background="Transparent" 
                                Foreground="White" FontSize="14" BorderThickness="0" Cursor="Hand"
                                Click="MinimizeButton_Click"/>
                        <Button x:Name="CloseButton" Content="âœ•" Width="35" Height="30" 
                                Background="Transparent" Foreground="White" FontSize="14" 
                                BorderThickness="0" Cursor="Hand" Click="CloseButton_Click"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONTENU PRINCIPAL (Pages) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid Grid.Row="1" Margin="30,20">
                
                <!-- Page 1: Bienvenue -->
                <Grid x:Name="WelcomePage" Visibility="Visible">
                    <StackPanel VerticalAlignment="Center">
                        <Border Background="#252536" CornerRadius="12" Padding="30" 
                                BorderBrush="#4A7FBF" BorderThickness="2">
                            <StackPanel>
                                <TextBlock Text="âœ… Bienvenue dans l'installation" 
                                           FontSize="24" FontWeight="Bold" Foreground="White" 
                                           HorizontalAlignment="Center" Margin="0,0,0,20"/>
                                
                                <TextBlock TextWrapping="Wrap" Foreground="#E0E0E0" FontSize="14" 
                                           TextAlignment="Center" Margin="0,0,0,25">
                                    <Run Text="Ce programme va installer "/><Run Text="XNRGY Engineering Automation Tools" FontWeight="Bold" Foreground="#00BFFF"/><Run Text=" sur votre ordinateur."/>
                                    <LineBreak/><LineBreak/>
                                    <Run Text="Cette suite d'outils permet l'automatisation des workflows Autodesk Vault et Inventor pour l'Ã©quipe engineering de XNRGY Climate Systems."/>
                                </TextBlock>

                                <Border Background="#1A3A5C" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                                    <StackPanel>
                                        <TextBlock Text="âœ… FonctionnalitÃ©s incluses:" FontWeight="Bold" 
                                                   Foreground="#00D4FF" FontSize="13" Margin="0,0,0,10"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0">
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ“¤" FontSize="12"/><Run Text=" Upload Module - Vault avec propriÃ©tÃ©s auto"/>
                                                </TextBlock>
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ“" FontSize="12"/><Run Text=" CrÃ©er Module - Copy Design natif"/>
                                                </TextBlock>
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ“" FontSize="12"/><Run Text=" Place Equipment - Insertion composants"/>
                                                </TextBlock>
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ”§" FontSize="12"/><Run Text=" Smart Tools - 25+ outils Inventor"/>
                                                </TextBlock>
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ“‹" FontSize="12"/><Run Text=" Checklist HVAC - Validation AHU"/>
                                                </TextBlock>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ“Š" FontSize="12"/><Run Text=" ACP Module - Analyse composants"/>
                                                </TextBlock>
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ“„" FontSize="12"/><Run Text=" Upload Template - Gestion templates"/>
                                                </TextBlock>
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ”" FontSize="12"/><Run Text=" DXF Verifier - Validation fichiers"/>
                                                </TextBlock>
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ”„" FontSize="12"/><Run Text=" Update Workspace - Sync Vault"/>
                                                </TextBlock>
                                                <TextBlock Foreground="#E0E0E0" FontSize="11" Margin="0,2">
                                                    <Run Text="ðŸ“‚" FontSize="12"/><Run Text=" Open Vault Project - Navigation rapide"/>
                                                </TextBlock>
                                            </StackPanel>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                <Border Background="#3C2415" CornerRadius="8" Padding="15">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="âš ï¸" FontSize="18" Margin="0,0,10,0"/>
                                        <TextBlock Foreground="#FFB74D" FontSize="12" TextWrapping="Wrap">
                                            <Run Text="Configuration requise:" FontWeight="Bold"/><LineBreak/>
                                            <Run Text="Windows 10/11 64-bit, .NET Framework 4.8, Inventor 2026, Vault 2026"/>
                                        </TextBlock>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>

                <!-- Page 2: Licence -->
                <Grid x:Name="LicensePage" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="ðŸ“œ Contrat de Licence" FontSize="20" FontWeight="Bold" 
                                   Foreground="White" Margin="0,0,0,15"/>
                        
                        <Border Background="#252536" CornerRadius="8" Padding="15" 
                                BorderBrush="#4A7FBF" BorderThickness="2" Height="300">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBlock x:Name="LicenseText" Foreground="#E0E0E0" FontSize="12" 
                                           TextWrapping="Wrap" FontFamily="Consolas"/>
                            </ScrollViewer>
                        </Border>

                        <CheckBox x:Name="AcceptLicenseCheckBox" Style="{StaticResource XnrgyCheckBox}"
                                  Margin="0,20,0,0" Checked="AcceptLicense_Changed" Unchecked="AcceptLicense_Changed">
                            <TextBlock Foreground="White" FontSize="13">
                                <Run Text="J'accepte les termes du contrat de licence" FontWeight="SemiBold"/>
                            </TextBlock>
                        </CheckBox>
                    </StackPanel>
                </Grid>

                <!-- Page 3: Dossier d'installation -->
                <Grid x:Name="FolderPage" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="ðŸ“ Dossier d'installation" FontSize="20" FontWeight="Bold" 
                                   Foreground="White" Margin="0,0,0,15"/>
                        
                        <Border Background="#252536" CornerRadius="8" Padding="20" 
                                BorderBrush="#4A7FBF" BorderThickness="2">
                            <StackPanel>
                                <TextBlock Text="Choisissez le dossier oÃ¹ installer l'application:" 
                                           Foreground="#E0E0E0" FontSize="13" Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBox x:Name="InstallPathTextBox" Grid.Column="0" 
                                             Style="{StaticResource PathTextBox}"
                                             Text="C:\Program Files\XNRGY Engineering Automation Tools"/>
                                    <Button Grid.Column="1" Content="ðŸ“‚ Parcourir" 
                                            Style="{StaticResource SecondaryButton}" 
                                            Margin="10,0,0,0" Click="BrowseFolder_Click"/>
                                </Grid>

                                <Border Background="#1A3A5C" CornerRadius="6" Padding="12" Margin="0,20,0,0">
                                    <StackPanel>
                                        <TextBlock Text="ðŸ’¾ Espace requis: ~150 MB" Foreground="#00D4FF" FontSize="12"/>
                                        <TextBlock x:Name="DiskSpaceText" Text="Espace disponible: Calcul en cours..." 
                                                   Foreground="#90EE90" FontSize="12" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>

                        <Border Background="#252536" CornerRadius="8" Padding="20" Margin="0,15,0,0"
                                BorderBrush="#4A7FBF" BorderThickness="2">
                            <StackPanel>
                                <TextBlock Text="Options d'installation:" Foreground="White" 
                                           FontWeight="SemiBold" FontSize="14" Margin="0,0,0,15"/>
                                
                                <CheckBox x:Name="CreateDesktopShortcut" Style="{StaticResource XnrgyCheckBox}" 
                                          IsChecked="True" Margin="0,5">
                                    <TextBlock Text="ðŸ–¥ï¸ CrÃ©er un raccourci sur le Bureau" Foreground="White"/>
                                </CheckBox>
                                <CheckBox x:Name="CreateStartMenuShortcut" Style="{StaticResource XnrgyCheckBox}" 
                                          IsChecked="True" Margin="0,5">
                                    <TextBlock Text="ðŸ“‹ Ajouter au menu DÃ©marrer" Foreground="White"/>
                                </CheckBox>
                                <CheckBox x:Name="LaunchAfterInstall" Style="{StaticResource XnrgyCheckBox}" 
                                          IsChecked="True" Margin="0,5">
                                    <TextBlock Text="â–¶ Lancer l'application aprÃ¨s l'installation" Foreground="White"/>
                                </CheckBox>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>

                <!-- Page 4: Installation en cours -->
                <Grid x:Name="InstallProgressPage" Visibility="Collapsed">
                    <StackPanel VerticalAlignment="Center">
                        <Border Background="#252536" CornerRadius="12" Padding="30" 
                                BorderBrush="#4A7FBF" BorderThickness="2">
                            <StackPanel>
                                <TextBlock Text="â³ Installation en cours..." FontSize="22" FontWeight="Bold" 
                                           Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,20"/>

                                <!-- Spinner -->
                                <Ellipse x:Name="Spinner" Width="60" Height="60" StrokeThickness="4" 
                                         Stroke="#0078D4" StrokeDashArray="3,2" 
                                         HorizontalAlignment="Center" Margin="0,0,0,20"
                                         RenderTransformOrigin="0.5,0.5">
                                    <Ellipse.RenderTransform>
                                        <RotateTransform x:Name="SpinnerRotation"/>
                                    </Ellipse.RenderTransform>
                                </Ellipse>

                                <ProgressBar x:Name="InstallProgress" Style="{StaticResource XnrgyProgressBar}"
                                             Value="0" Maximum="100" Height="12" Margin="0,0,0,15"/>
                                
                                <TextBlock x:Name="ProgressPercentText" Text="0%" FontSize="16" 
                                           FontWeight="Bold" Foreground="#00D4FF" 
                                           HorizontalAlignment="Center" Margin="0,0,0,10"/>
                                
                                <TextBlock x:Name="CurrentActionText" Text="PrÃ©paration de l'installation..." 
                                           Foreground="#B0B0B0" FontSize="12" 
                                           HorizontalAlignment="Center" TextAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>

                <!-- Page 5: Installation terminÃ©e -->
                <Grid x:Name="CompletePage" Visibility="Collapsed">
                    <StackPanel VerticalAlignment="Center">
                        <Border Background="#252536" CornerRadius="12" Padding="30" 
                                BorderBrush="#00D26A" BorderThickness="2">
                            <StackPanel HorizontalAlignment="Center">
                                <Border Background="#00D26A" CornerRadius="50" Width="80" Height="80" Margin="0,0,0,20">
                                    <TextBlock Text="âœ“" FontSize="45" FontWeight="Bold" Foreground="White"
                                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <TextBlock Text="âœ… Installation terminÃ©e !" FontSize="24" FontWeight="Bold" 
                                           Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                                
                                <TextBlock Foreground="#E0E0E0" FontSize="14" TextAlignment="Center" Margin="0,0,0,20">
                                    <Run Text="XNRGY Engineering Automation Tools a Ã©tÃ© installÃ© avec succÃ¨s."/><LineBreak/>
                                    <Run Text="Vous pouvez maintenant utiliser l'application."/>
                                </TextBlock>

                                <Border Background="#1A3A5C" CornerRadius="8" Padding="15">
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“ Emplacement:" FontWeight="Bold" Foreground="#00D4FF" FontSize="12"/>
                                        <TextBlock x:Name="FinalInstallPath" Foreground="#90EE90" FontSize="11" 
                                                   Margin="0,5,0,0" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>

            </Grid>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER avec Boutons Navigation â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Grid.Row="2" Background="#252536" CornerRadius="0,0,10,10" Padding="20,15">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Copyright -->
                    <TextBlock Grid.Column="0" 
                               Text="XNRGY Engineering Automation Tools - v1.0.0 - R 2026-01-10 - By Mohammed Amine Elgalai - XNRGY CLIMATE SYSTEMS ULC" 
                               Foreground="White" FontWeight="Bold" FontSize="10" VerticalAlignment="Center"/>

                    <!-- Boutons Navigation -->
                    <Button x:Name="BackButton" Grid.Column="2" Content="â—€ Retour" 
                            Style="{StaticResource SecondaryButton}" 
                            Click="BackButton_Click" Visibility="Collapsed" Margin="0,0,10,0"/>
                    
                    <Button x:Name="NextButton" Grid.Column="3" Content="Suivant â–¶" 
                            Style="{StaticResource InstallerButton}" Click="NextButton_Click"/>
                    
                    <Button x:Name="InstallButton" Grid.Column="3" Content="âš¡ Installer" 
                            Style="{StaticResource InstallerButton}" Click="InstallButton_Click" 
                            Visibility="Collapsed"/>
                    
                    <Button x:Name="FinishButton" Grid.Column="3" Content="âœ“ Terminer" 
                            Style="{StaticResource InstallerButton}" Click="FinishButton_Click" 
                            Visibility="Collapsed"/>
                    
                    <Button x:Name="CancelButton" Grid.Column="3" Content="âœ• Annuler" 
                            Style="{StaticResource DangerButton}" Click="CancelButton_Click" 
                            Visibility="Collapsed" Margin="10,0,0,0"/>
                </Grid>
            </Border>

        </Grid>
    </Border>
</Window>
